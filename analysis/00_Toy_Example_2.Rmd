---
title: "00_Toy_Example_2"
author: "Frances Lin"
date: "3/27/2022"
output: pdf_document
---

## Load packages

```{r}
library(INLA)
```

## Simulate the data

```{r}
N <- 100 # 500, 5000, 25000, 100000
x <- rnorm(N, mean = 5, sd = 1)
nu <- rnorm(N, 0, 0.1)
mu <- exp(1 + 0.5 * x + nu)
y <- rpois(N, mu)
data <- list(x = x, y = y, N = N, nu = nu, mu = mu)
```

## Fit the Poisson GLM

```{r}
# Fit the Poisson GLM
nu <- 1:N
model <- inla(y ~ x + f(nu, model = "iid"),
              family = "poisson",
              data = data,
              control.predictor = list(link = 1)
)
```

## Produce results summaries

```{r}
summary(model)
```

\newpage

## Reference

Morrison, K. (2017). A gentle INLA tutorial. Precision Analytics. [https://www.precision-analytics.ca/articles/a-gentle-inla-tutorial/.](https://www.precision-analytics.ca/articles/a-gentle-inla-tutorial/)

