<!DOCTYPE html>
<html class="no-js" lang="en-US"
	prefix="og: https://ogp.me/ns#"  prefix="og: http://ogp.me/ns#">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatial Data Analysis with INLA | R-bloggers</title>
<!-- This site is running CAOS for Wordpress -->

		<!-- All in One SEO 4.1.4.4 -->
		<meta name="description" content="by Virgilio Gómez Rubio Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ..." />
		<meta name="robots" content="max-image-preview:large" />
		<script src="/cdn-cgi/apps/head/pAx-dKbLyle7umPnDyx7D0pQbKA.js"></script><link rel="canonical" href="https://www.r-bloggers.com/2019/11/spatial-data-analysis-with-inla/" />
		<meta property="og:locale" content="en_US" />
		<meta property="og:site_name" content="R-bloggers" />
		<meta property="og:type" content="article" />
		<meta property="og:title" content="Spatial Data Analysis with INLA | R-bloggers" />
		<meta property="og:description" content="by Virgilio Gómez Rubio Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ..." />
		<meta property="og:url" content="https://www.r-bloggers.com/2019/11/spatial-data-analysis-with-inla/" />
		<meta property="fb:admins" content="rbloggers" />
		<meta property="og:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png" />
		<meta property="og:image:secure_url" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png" />
		<meta property="article:published_time" content="2019-11-05T00:00:00+00:00" />
		<meta property="article:modified_time" content="2019-11-05T00:00:00+00:00" />
		<meta property="article:publisher" content="https://www.facebook.com/rbloggers/" />
		<meta name="twitter:card" content="summary" />
		<meta name="twitter:site" content="@rbloggers" />
		<meta name="twitter:domain" content="www.r-bloggers.com" />
		<meta name="twitter:title" content="Spatial Data Analysis with INLA | R-bloggers" />
		<meta name="twitter:description" content="by Virgilio Gómez Rubio Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ..." />
		<meta name="twitter:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png" />
		<script type="application/ld+json" class="aioseo-schema">
			{"@context":"https:\/\/schema.org","@graph":[{"@type":"WebSite","@id":"https:\/\/www.r-bloggers.com\/#website","url":"https:\/\/www.r-bloggers.com\/","name":"R-bloggers","description":"R news and tutorials contributed by hundreds of R bloggers","inLanguage":"en-US","publisher":{"@id":"https:\/\/www.r-bloggers.com\/#organization"}},{"@type":"Organization","@id":"https:\/\/www.r-bloggers.com\/#organization","name":"R-bloggers","url":"https:\/\/www.r-bloggers.com\/","logo":{"@type":"ImageObject","@id":"https:\/\/www.r-bloggers.com\/#organizationLogo","url":"https:\/\/www.r-bloggers.com\/wp-content\/uploads\/2020\/07\/R_02.webp"},"image":{"@id":"https:\/\/www.r-bloggers.com\/#organizationLogo"},"sameAs":["https:\/\/www.facebook.com\/rbloggers\/","https:\/\/twitter.com\/rbloggers"]},{"@type":"BreadcrumbList","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#breadcrumblist","itemListElement":[{"@type":"ListItem","@id":"https:\/\/www.r-bloggers.com\/#listItem","position":1,"item":{"@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/","name":"Home","description":"R news and tutorials contributed by hundreds of R bloggers","url":"https:\/\/www.r-bloggers.com\/"},"nextItem":"https:\/\/www.r-bloggers.com\/2019\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.r-bloggers.com\/2019\/#listItem","position":2,"item":{"@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/2019\/","name":"2019","url":"https:\/\/www.r-bloggers.com\/2019\/"},"nextItem":"https:\/\/www.r-bloggers.com\/2019\/11\/#listItem","previousItem":"https:\/\/www.r-bloggers.com\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/#listItem","position":3,"item":{"@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/","name":"November","url":"https:\/\/www.r-bloggers.com\/2019\/11\/"},"nextItem":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#listItem","previousItem":"https:\/\/www.r-bloggers.com\/2019\/#listItem"},{"@type":"ListItem","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#listItem","position":4,"item":{"@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/","name":"Spatial Data Analysis with INLA","description":"by Virgilio G\u00f3mez Rubio Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ...","url":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/"},"previousItem":"https:\/\/www.r-bloggers.com\/2019\/11\/#listItem"}]},{"@type":"Person","@id":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/#author","url":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/","name":"R on Coding Club UC3M"},{"@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#webpage","url":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/","name":"Spatial Data Analysis with INLA | R-bloggers","description":"by Virgilio G\u00f3mez Rubio Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ...","inLanguage":"en-US","isPartOf":{"@id":"https:\/\/www.r-bloggers.com\/#website"},"breadcrumb":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#breadcrumblist"},"author":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/#author","creator":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/#author","datePublished":"2019-11-05T00:00:00-06:00","dateModified":"2019-11-05T00:00:00-06:00"},{"@type":"Article","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#article","name":"Spatial Data Analysis with INLA | R-bloggers","description":"by Virgilio G\u00f3mez Rubio Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ...","inLanguage":"en-US","headline":"Spatial Data Analysis with INLA","author":{"@id":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/#author"},"publisher":{"@id":"https:\/\/www.r-bloggers.com\/#organization"},"datePublished":"2019-11-05T00:00:00-06:00","dateModified":"2019-11-05T00:00:00-06:00","articleSection":"R bloggers","mainEntityOfPage":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#webpage"},"isPartOf":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#webpage"},"image":{"@type":"ImageObject","@id":"https:\/\/www.r-bloggers.com\/#articleImage","url":"https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-5-1.png"}}]}
		</script>
		<!-- All in One SEO -->


<!-- Open Graph Meta Tags generated by MashShare 3.8.0 - https://mashshare.net -->
<meta property="og:type" content="article" /> 
<meta property="og:title" content="Spatial Data Analysis with INLA" />
<meta property="og:description" content="&lt;div style = &quot;width:60%; display: inline-block; float:left; &quot;&gt;  by Virgilio Gómez Rubio           Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ...&lt;/div&gt;&lt;div style = &quot;width: 40%; display: inline-block; float:right;&quot;&gt;&lt;img src=' https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png' width = &quot;200&quot;  style = &quot;padding: 10px;&quot; /&gt;&lt;/div&gt;&lt;div style=&quot;clear: both;&quot;&gt;&lt;/div&gt;" />
<meta property="og:url" content="https://www.r-bloggers.com/2019/11/spatial-data-analysis-with-inla/" />
<meta property="og:site_name" content="R-bloggers" />
<meta property="article:publisher" content="https://www.facebook.com/rbloggers/" />
<meta property="article:published_time" content="2019-11-04T18:00:00-06:00" />
<meta property="article:modified_time" content="2019-11-04T18:00:00-06:00" />
<meta property="og:updated_time" content="2019-11-04T18:00:00-06:00" />
<!-- Open Graph Meta Tags generated by MashShare 3.8.0 - https://www.mashshare.net -->
<!-- Twitter Card generated by MashShare 3.8.0 - https://www.mashshare.net -->
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spatial Data Analysis with INLA">
<meta name="twitter:description" content="&lt;div style = &quot;width:60%; display: inline-block; float:left; &quot;&gt;  by Virgilio Gómez Rubio           Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA ...&lt;/div&gt;&lt;div style = &quot;width: 40%; display: inline-block; float:right;&quot;&gt;&lt;img src=' https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png' width = &quot;200&quot;  style = &quot;padding: 10px;&quot; /&gt;&lt;/div&gt;&lt;div style=&quot;clear: both;&quot;&gt;&lt;/div&gt;">
<meta name="twitter:site" content="@Rbloggers">
<!-- Twitter Card generated by MashShare 3.8.0 - https://www.mashshare.net -->

<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel='preconnect' href='//www.google-analytics.com' />
		<script type="376714593608de8c39e32b38-text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.0.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.r-bloggers.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.5.6"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([55357,56424,8205,55356,57212],[55357,56424,8203,55356,57212])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel='stylesheet' id='snp_styles_reset-css'  href='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/themes/reset.min.css?ver=5.5.6' type='text/css' media='all' />
<link rel='stylesheet' id='fancybox2-css'  href='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/fancybox2/jquery.fancybox.min.css?ver=5.5.6' type='text/css' media='all' />
<link rel='stylesheet' id='snp_styles_theme6-css'  href='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/themes/theme6/css/theme6.css?ver=5.5.6' type='text/css' media='all' />
<link rel='stylesheet' id='wp-block-library-css'  href='https://c0.wp.com/c/5.5.6/wp-includes/css/dist/block-library/style.min.css' type='text/css' media='all' />
<link rel='stylesheet' id='mashsb-styles-css'  href='https://www.r-bloggers.com/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.0' type='text/css' media='all' />
<style id='mashsb-styles-inline-css' type='text/css'>
.mashsb-count {color:#cccccc;}@media only screen and (min-width:568px){.mashsb-buttons a {min-width: 177px;}}
</style>
<link rel='stylesheet' id='wpt-twitter-feed-css'  href='https://www.r-bloggers.com/wp-content/plugins/wp-to-twitter/css/twitter-feed.css?ver=5.5.6' type='text/css' media='all' />
<style id="mh-google-fonts-css" media="all">/* cyrillic-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWV0exoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWVQexoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWVwexoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWVMexoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+0370-03FF;
}
/* hebrew */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWVIexoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* vietnamese */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWV8exoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWV4exoMUdjFXmSU_.woff) format('woff');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Open Sans';
  font-style: italic;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memQYaGs126MiZpBA-UFUIcVXSCEkx2cmqvXlWq8tWZ0Pw86hd0Rk8ZkWVAexoMUdjFXmQ.woff) format('woff');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0370-03FF;
}
/* hebrew */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* vietnamese */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 300;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0370-03FF;
}
/* hebrew */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* vietnamese */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 400;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0370-03FF;
}
/* hebrew */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* vietnamese */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 600;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
/* cyrillic-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSKmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
/* cyrillic */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSumu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
/* greek-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSOmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+1F00-1FFF;
}
/* greek */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSymu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0370-03FF;
}
/* hebrew */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS2mu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0590-05FF, U+200C-2010, U+20AA, U+25CC, U+FB1D-FB4F;
}
/* vietnamese */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSCmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB;
}
/* latin-ext */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTSGmu0SC55K5gw.woff2) format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
/* latin */
@font-face {
  font-family: 'Open Sans';
  font-style: normal;
  font-weight: 700;
  font-stretch: 100%;
  font-display: swap;
  src: url(/fonts.gstatic.com/s/opensans/v28/memvYaGs126MiZpBA-UvWbX2vVnXBbObj2OVTS-mu0SC55I.woff2) format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
</style>
<link rel='stylesheet' id='mh-style-css'  href='https://www.r-bloggers.com/wp-content/themes/mh-corporate-basic/style.css?ver=5.5.6' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://c0.wp.com/p/jetpack/7.3.3/css/jetpack.css' type='text/css' media='all' />
<script type="376714593608de8c39e32b38-text/javascript" src='https://c0.wp.com/c/5.5.6/wp-includes/js/jquery/jquery.js' id='jquery-core-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" id='jetpack_related-posts-js-extra'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://c0.wp.com/p/jetpack/7.3.3/_inc/build/related-posts/related-posts.min.js' id='jetpack_related-posts-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" id='mashsb-js-extra'>
/* <![CDATA[ */
var mashsb = {"shares":"0","round_shares":"1","animate_shares":"0","dynamic_buttons":"0","share_url":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/","title":"Spatial+Data+Analysis+with+INLA","image":null,"desc":"<div style = \"width:60%; display: inline-block; float:left; \"> \nby Virgilio G\u00f3mez Rubio\n        \n\nIntroduction\nIn this session I will focus on Bayesian inference using the integrated nested\nLaplace approximation (INLA) method. As described in Rue et al. (2009), INLA\ncan be used to estimate the posterior marginal distribution of Bayesian\nhierarchical models. This method is implemented in the INLA ...<\/div><div style = \"width: 40%; display: inline-block; float:right;\"><img src=' https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-5-1.png' width = \"200\"  style = \"padding: 10px;\" \/><\/div><div style=\"clear: both;\"><\/div>","hashtag":"Rbloggers","subscribe":"link","subscribe_url":"https:\/\/feedburner.google.com\/fb\/a\/mailverify?uri=RBloggers","activestatus":"1","singular":"1","twitter_popup":"1","refresh":"0","nonce":"e688ca1182","postid":"189109","servertime":"1633093723","ajaxurl":"https:\/\/www.r-bloggers.com\/wp-admin\/admin-ajax.php"};
/* ]]> */
</script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.0' id='mashsb-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/themes/mh-corporate-basic/js/scripts.js?ver=5.5.6' id='mh-scripts-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/uploads/caos/analytics.js' id='caos-analytics-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" id='caos-analytics-js-after'>
    


    window.ga = window.ga || function() {
        (ga.q = ga.q || []).push(arguments);
    };
    ga.l = +new Date;

        ga('create', 'UA-419807-53', {"cookieName":"caosLocalGa","cookieDomain":"www.r-bloggers.com","cookieExpires":2592000,"cookieFlags":"samesite=none;secure","siteSpeedSampleRate":"1"});
        ga('require', 'displayfeatures');
ga('set', 'anonymizeIp', true);    ga('send', 'pageview');
                

    function _caosLt(event) {
        if (typeof gtag !== 'function' && typeof ga !== 'function') {
            return;
        }

        /* Only run on left clicks. */
        if (event.which !== 1) {
            return;
        }

        var eventLink = event.srcElement || event.target;

        /* Loop up the DOM tree through parent elements if clicked element is not a link (eg: an image inside a link) */
        while (eventLink && (typeof eventLink.tagName == 'undefined' || eventLink.tagName.toLowerCase() !== 'a' || !eventLink.href)) {
            eventLink = eventLink.parentNode;
        }

        /* if a link with valid href has been clicked */
        if (eventLink && eventLink.href) {
            var link = eventLink.href;
            /* Only if it is an external link */
            if (link.indexOf(location.host) === -1 && !link.match(/^javascript\:/i)) {
                /* Is actual target set and not _(self|parent|top)? */
                var target = (eventLink.target && !eventLink.target.match(/^_(self|parent|top)$/i)) ? eventLink.target : false;
                /* Assume a target if Ctrl|shift|meta-click */
                if (event.ctrlKey || event.shiftKey || event.metaKey || event.which === 2) {
                    target = '_blank';
                }

                var hbrun = false; // tracker has not yet run

                /* HitCallback to open link in same window after tracker */
                var hitBack = function() {
                    /* run once only */
                    if (hbrun) return;
                    hbrun = true;
                    window.location.href = link;
                };

                if (target) {
                    /* If target opens a new window then just track */
                                            ga('send', 'event', 'Outbound Link Tracking', 'click', link);
                                    } else {
                    /* Prevent standard click, track then open */
                    event.preventDefault ? event.preventDefault() : event.returnValue != 1;
                    /* send event with callback */
                                            ga('send', 'event', 'Outbound Link Tracking', 'click', link, {
                            'transport': 'beacon',
                            'hitCallback': hitBack
                        });
                                        /* Run hitCallback again if GA takes longer than 1 second */
                    setTimeout(hitBack, 1000);
                }
            }
        }
    }

    var _window = window;

    /* Use "click" if touchscreen device, else "mousedown" */
    var _caosLtEvent = ('ontouchstart' in _window) ? 'click' : 'mousedown';

    /* Attach the event to all clicks in the document after page has loaded */
    _window.addEventListener ? _window.addEventListener('load', function() {
        document.body.addEventListener(_caosLtEvent, _caosLt, !1);
    }, !1) : _window.attachEvent && _window.attachEvent('onload', function() {
        document.body.attachEvent('on' + _caosLtEvent, _caosLt);
    });
</script>
<link rel="https://api.w.org/" href="https://www.r-bloggers.com/wp-json/" /><link rel="alternate" type="application/json" href="https://www.r-bloggers.com/wp-json/wp/v2/posts/189109" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.r-bloggers.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.r-bloggers.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Data Scientist or Data Engineer – what’s the difference?' href='https://www.r-bloggers.com/2019/11/data-scientist-or-data-engineer-whats-the-difference/' />
<link rel='next' title='Data Science on Rails: Analyzing Customer Churn' href='https://www.r-bloggers.com/2019/11/data-science-on-rails-analyzing-customer-churn/' />
<meta name="generator" content="WordPress 5.5.6" />
<link rel='shortlink' href='https://www.r-bloggers.com/?p=189109' />
<link rel="alternate" type="application/json+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2F2019%2F11%2Fspatial-data-analysis-with-inla%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.r-bloggers.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.r-bloggers.com%2F2019%2F11%2Fspatial-data-analysis-with-inla%2F&#038;format=xml" />

<link rel='dns-prefetch' href='//i0.wp.com'/>
<link rel='dns-prefetch' href='//i1.wp.com'/>
<link rel='dns-prefetch' href='//i2.wp.com'/>
<link rel='dns-prefetch' href='//c0.wp.com'/>
<style type='text/css'>img#wpstats{display:none}</style><!--[if lt IE 9]>
<script src="https://www.r-bloggers.com/wp-content/themes/mh-corporate-basic/js/css3-mediaqueries.js"></script>
<![endif]-->
<link rel="amphtml" href="https://www.r-bloggers.com/2019/11/spatial-data-analysis-with-inla/amp/">			<style type="text/css">
				/* If html does not have either class, do not show lazy loaded images. */
				html:not( .jetpack-lazy-images-js-enabled ):not( .js ) .jetpack-lazy-image {
					display: none;
				}
			</style>
			<script type="376714593608de8c39e32b38-text/javascript">
				document.documentElement.classList.add(
					'jetpack-lazy-images-js-enabled'
				);
			</script>
		
<!-- WordPress Facebook Open Graph protocol plugin (WPFBOGP v2.0.13) http://rynoweb.com/wordpress-plugins/ -->
<meta property="fb:app_id" content="143207055763488"/>
<meta property="og:image" content="https://www.r-bloggers.com/wp-content/uploads/2016/08/R_single_01-200-1.png"/>
<meta property="og:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-33-1.png"/>
<meta property="og:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-31-1.png"/>
<meta property="og:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-15-1.png"/>
<meta property="og:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-12-1.png"/>
<meta property="og:image" content="https://codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png"/>
<!-- // end wpfbogp -->
<link rel="icon" href="https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=32%2C32&#038;ssl=1" sizes="32x32" />
<link rel="icon" href="https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=192%2C192&#038;ssl=1" sizes="192x192" />
<link rel="apple-touch-icon" href="https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=180%2C180&#038;ssl=1" />
<meta name="msapplication-TileImage" content="https://i0.wp.com/www.r-bloggers.com/wp-content/uploads/2016/08/cropped-R_single_01-200.png?fit=270%2C270&#038;ssl=1" />
<link rel="preload" href="/wp-includes/js/wp-emoji-release.min.js?ver=5.5.6" as="script"><link rel="preload" href="/wp-content/plugins/mashsharer/assets/js/mashsb.min.js?ver=3.8.0" as="script"><link rel="preload" href="/wp-content/themes/mh-corporate-basic/js/scripts.js?ver=5.5.6" as="script"><link rel="preload" href="/wp-content/uploads/caos/analytics.js" as="script"><link rel="preload" href="/wp-content/plugins/arscode-ninja-popups/themes/reset.min.css?ver=5.5.6" as="style"><link rel="preload" href="/wp-content/plugins/arscode-ninja-popups/fancybox2/jquery.fancybox.min.css?ver=5.5.6" as="style"><link rel="preload" href="/wp-content/plugins/arscode-ninja-popups/themes/theme6/css/theme6.css?ver=5.5.6" as="style"><link rel="preload" href="/wp-content/plugins/mashsharer/assets/css/mashsb.min.css?ver=3.8.0" as="style"><link rel="preload" href="/wp-content/plugins/wp-to-twitter/css/twitter-feed.css?ver=5.5.6" as="style"><link rel="preload" href="/wp-content/themes/mh-corporate-basic/style.css?ver=5.5.6" as="style">		<style type="text/css" id="wp-custom-css">
			hr {
    margin-top: 2px;
    margin-bottom: 2px;
}


pre, code {
  overflow: auto;
  white-space: pre;
	    font-family: "Source Code Pro","Liberation Mono","Courier New",Courier,monospace;
    font-size: 12px;
    line-height: 1.35em;
    overflow: hidden;
    /*white-space: pre-wrap;*/
    word-wrap: break-word;
    margin: 0 0 20px 0;
    padding: 0;
    position: relative;
    text-align: left;
    direction: ltr;
	  overflow-x: auto;
	  padding-left: 17px;
}

table {
  display: block;
  overflow-x: auto;
  white-space: nowrap;
}

/*deal with mathjax overflow*/
.MathJax_Display {
    overflow-x: auto;
    overflow-y: hidden; /* need to verify this works well*/
    display: block;
}		</style>
		</head>
<body class="post-template-default single single-post postid-189109 single-format-standard">
<div class="mh-container">
<div class="wrapper-corporate">
<header class="header-wrap">
	<a href="https://www.r-bloggers.com/" title="R-bloggers" rel="home">
<div class="logo-wrap" role="banner">
<img src="https://www.r-bloggers.com/wp-content/uploads/2020/07/R_02.webp" height="90" width="290" alt="R-bloggers" />
<div class="logo logo-overlay">
<h1 class="logo-name">R-bloggers</h1>
<h2 class="logo-desc">R news and tutorials contributed by hundreds of R bloggers</h2>
</div>
</div>
</a>
	<nav class="main-nav clearfix">
		<div class="menu-top-nav-container"><ul id="menu-top-nav" class="menu"><li id="menu-item-48314" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-48314"><a href="https://www.r-bloggers.com">Home</a></li>
<li id="menu-item-92333" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-92333"><a href="https://www.r-bloggers.com/about/">About</a></li>
<li id="menu-item-50111" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-50111"><a href="https://feeds.feedburner.com/RBloggers">RSS</a></li>
<li id="menu-item-48313" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48313"><a href="https://www.r-bloggers.com/add-your-blog/">add your blog!</a></li>
<li id="menu-item-111419" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-111419"><a href="https://www.r-bloggers.com/how-to-learn-r-2/">Learn R</a></li>
<li id="menu-item-75513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-75513"><a href="https://www.r-users.com/">R jobs</a>
<ul class="sub-menu">
	<li id="menu-item-76945" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76945"><a href="https://www.r-users.com/submit-job/">Submit a new job (it&#8217;s free)</a></li>
	<li id="menu-item-76946" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-76946"><a href="https://www.r-users.com/">Browse latest jobs (also free)</a></li>
</ul>
</li>
<li id="menu-item-48311" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-48311"><a href="https://www.r-bloggers.com/contact-us/">Contact us</a></li>
</ul></div>	</nav>
</header>
<div class="mh-wrapper clearfix">
	<div class="mh-content left"><article class="post-189109 post type-post status-publish format-standard hentry category-r-bloggers">
	<header class="post-header">
		<h1 class="entry-title">Spatial Data Analysis with INLA</h1>
		<p class="meta post-meta">Posted on <span class="updated">November 4, 2019</span>  by <span class="vcard author"><a class="fn" href="https://www.r-bloggers.com/author/r-on-coding-club-uc3m/">R on Coding Club UC3M</a></span>  in <a href="https://www.r-bloggers.com/category/r-bloggers/" rel="category tag">R bloggers</a> | 0 Comments</p>
	</header>
	<div class="entry clearfix">
				<p class="syndicated-attribution"><!-- 
<div style="min-height: 30px;">
[social4i size="small" align="align-left"]
</div>
-->

<div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 12px;">
[This article was first published on  <strong><a href="https://codingclubuc3m.rbind.io/post/2019-11-05/"> R on Coding Club UC3M</a></strong>, and kindly contributed to <a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers</a>].  (You can report issue about the content on this page <a href="https://www.r-bloggers.com/contact-us/">here</a>)
<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="https://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div></p>
<aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-large mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2F2019%2F11%2Fspatial-data-analysis-with-inla%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-large mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Spatial%20Data%20Analysis%20with%20INLA&url=https://www.r-bloggers.com/2019/11/spatial-data-analysis-with-inla/&via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-large mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.0-->
        <p>by Virgilio Gómez Rubio</p>
        
<script src="https://codingclubuc3m.rbind.io/rmarkdown-libs/htmlwidgets/htmlwidgets.js" type="376714593608de8c39e32b38-text/javascript"></script>
<script src="https://codingclubuc3m.rbind.io/rmarkdown-libs/pymjs/pym.v1.js" type="376714593608de8c39e32b38-text/javascript"></script>
<script src="https://codingclubuc3m.rbind.io/rmarkdown-libs/widgetframe-binding/widgetframe.js" type="376714593608de8c39e32b38-text/javascript"></script>


<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In this session I will focus on Bayesian inference using the integrated nested
Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA
can be used to estimate the posterior marginal distribution of Bayesian
hierarchical models. This method is implemented in the <code>INLA</code> package available
for the <code>R</code> programming language. Given that the types of models that INLA can
fit are quite wide, we will focus on spatial models for the analysis of lattice
data. Hence,</p>
</div>
<div id="bayesian-inference" class="section level2">
<h2>Bayesian inference</h2>
<p>A Bayesian hierarchical model can be defined as follows:</p>
<p><span class="math display">\[
y_i \sim f(y_i \mid \mathbf{x}, \theta_1)
\]</span></p>
<p><span class="math display">\[
\mathbf{x} \sim GMRF(\theta_2)
\]</span></p>
<p><span class="math display">\[
\theta \sim \pi(\theta)
\]</span></p>
<p>Here, <span class="math inline">\(\mathbf{y} = (y_1, \ldots, y_n)\)</span> is a vector of responses, <span class="math inline">\(\mathbf{x}\)</span>
a vector of latent effects and <span class="math inline">\(\theta = (\theta_1, \theta_2)\)</span> a vector of
hyperparameters. <span class="math inline">\(GMRF(\theta_2)\)</span> is a Gaussian Markov random field (GMRF) with
zero mean, which can be regarded as a multivariate Gaussian distribution
with zero mean and sparse precision matrix that depends on hyperparameters
<span class="math inline">\(\theta_2\)</span>.</p>
<p>Fitting a Bayesian model means computing the posterior distribution of
<span class="math inline">\(\mathbf{x}\)</span> and <span class="math inline">\(\theta\)</span> <span class="math inline">\(\pi(\theta, \mathbf{x} \mid y)\)</span>. This can be obtained
by using Bayes’ rule as follows:</p>
<p><span class="math display">\[
\pi(\theta, \mathbf{x} \mid y)  \propto \pi(y \mid \theta, \mathbf{x})\pi(\theta)
\]</span></p>
<p>Once the joint posterior distribution is known, we could compute posterior
probabilities of linear predictors, random effects, sums of random effects,
etc. Depending on the likelihood and the prior distribution computing
<span class="math inline">\(\pi(\theta, \mathbf{x} \mid y)\)</span> can be very difficult.</p>
<div id="inference-with-markov-chain-monte-carlo" class="section level3">
<h3>Inference with Markov chain Monte Carlo</h3>
<p>In the last 20-30 years some computational approaches have been proposed to
estimate <span class="math inline">\(\pi(\theta, \mathbf{x} \mid y)\)</span> with Monte Carlo methods. In
particular, Markov chain Monte Carlo (MCMC) methods provide simulations from
the ensemble of model parameters, i.e., a multivariate distribution. This will
allow us to estimate the joint posterior distribution.</p>
<p>However, we may be interested in a single parameter or a subset of the
parameters. Inference for this subset of parameters can be done by simply
ignoring the samples for the other parameters</p>
<p>Using the samples it is possible to compute the posterior distribution of any
function on the model parameters. Notice that MCMC may require lots of simulations for
valid inference. Also, we must check that the burn-in period has ended, i.e.,
we have reached the posterior distribution</p>
</div>
</div>
<div id="integrated-nested-laplace-approximation" class="section level2">
<h2>Integrated Nested Laplace Approximation</h2>
<p>Sometimes we only need marginal inference on some parameters, i.e., we
need <span class="math inline">\(\pi(\theta_i \mid y)\)</span>. Rue et al. (2009) propose a way of approximating
the marginal distributions using different approximations to the distributions
involved and using the Laplace approximation for the integrals.</p>
<p>Now we are dealing with (many) univariate distributions. This is
computationally faster because numerical integration techniques are used
instead of Monte Carlo sampling. The marginal distributions for the latent
effects and hyper-parameters can be written as</p>
<p><span class="math display">\[
\pi(x_i \mid \mathbf{y}) = \int \pi(x_i \mid \mathbf{\theta}, \mathbf{y})  \pi(\mathbf{\theta}\mid \mathbf{y}) d\mathbf{\theta}
\]</span>

and</p>
<p><span class="math display">\[
\pi(\theta_j\mid \mathbf{y}) = \int \pi(\mathbf{\theta}\mid  \mathbf{y})  d\mathbf{\theta}_{-j} 
\]</span></p>
<p>The posterior distribution of the hyperparameters <span class="math inline">\(\pi(\mathbf{\theta}\mid \mathbf{y})\)</span> is approximated using different methods.</p>
<div id="r-inla-package" class="section level3">
<h3><code>R-INLA</code> package</h3>
<p>The INLA method is implemented in the <code>INLA</code> (also known as <code>R-INLA</code>) package,
which is available from <a href="http://www.r-inla.org/" rel="nofollow" target="_blank">http://www.r-inla.org</a>.
This package relies on the <code>inla()</code>-function to fit the models. This functions
works in a similar way as, for example, <code>glm()</code>. The model is defined in a  and there is a flexible way of defining the likelihood, priors and
latent effects in the model.</p>
<p>The output provides the posterior marginals of the model parameters and latent
effects, linear predictors, and some other derived quantities (such as linear
combinations of the model latent effects). In addition, <code>INLA</code> provides tools
to manipulate <span class="math inline">\(\pi(\cdot \mid y)\)</span> to compute <span class="math inline">\(\pi(f(\cdot) \mid y)\)</span>. <code>INLA</code> can compute some model assessment/choice: Marginal likelihood, DIC, CPO, …</p>
</div>
<div id="spatial-latent-effects" class="section level3">
<h3>Spatial latent effects</h3>
<p>The following table summarizes some of the spatial latent effects available
in <code>INLA</code>:</p>
<table>
<thead>
<tr class="header">
<th align="center">Name in <code>f()</code></th>
<th align="center">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><code>generic0</code></td>
<td align="center"><span class="math inline">\(\Sigma=\frac{1}{\tau}Q^{-1}\)</span></td>
</tr>
<tr class="even">
<td align="center"><code>generic1</code></td>
<td align="center"><span class="math inline">\(\Sigma=\frac{1}{\tau}(I_n-\frac{\rho}{\lambda_{max}}C)^{-1}\)</span></td>
</tr>
<tr class="odd">
<td align="center"><code>besag</code></td>
<td align="center">Intrinsic CAR</td>
</tr>
<tr class="even">
<td align="center"><code>besagproper</code></td>
<td align="center">Proper CAR</td>
</tr>
<tr class="odd">
<td align="center"><code>bym</code></td>
<td align="center">Convolution model</td>
</tr>
<tr class="even">
<td align="center"><code>rw2d</code></td>
<td align="center">Random walk 2-D</td>
</tr>
<tr class="odd">
<td align="center"><code>matern2d</code></td>
<td align="center">Matèrn correlation (discrete)</td>
</tr>
<tr class="even">
<td align="center"><code>slm</code></td>
<td align="center">Spatial lag model</td>
</tr>
<tr class="odd">
<td align="center"><code>spde</code></td>
<td align="center">Matèrn correlation (continuous)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="dataset-leukemia-in-upstate-new-york" class="section level2">
<h2>Dataset: Leukemia in upstate New York</h2>
<p>To illustrate how spatial models are fitted with <code>INLA</code>, the New York leukemia
dataset will be used. This has been widely analyzed in the literature (see, for
example, Waller and Gotway, 2004) and it is available in the <code>DClusterm</code>
package. The dataset records a number of cases of leukemia in upstate New York
at the census tract level. Some of the variables in the dataset are:</p>
<ul>
<li><code>Cases</code>: Number of leukemia cases in the period 1978-1982.</li>
<li><code>POP8</code>: Population in 1980.</li>
<li><code>PCTOWNHOME</code>: Proportion of people who own their home.</li>
<li><code>PCTAGE65P</code>: Proportion of people aged 65 or more.</li>
<li><code>AVGIDIST</code>: Average inverse distance to the nearest Trichloroethene (TCE) site.</li>
</ul>
<p>Note that the interest is on the exposure to TCE, using <code>AVGIDIST</code> as a proxy
for exposure. Variables <code>PCTOWNHOME</code> and <code>PCTAGE65P</code> will act as possible
confounders that must be included in the model. <strong>However, we will not do it
here because we want to test how the spatial latent effects capture residual
spatial variation.</strong></p>
<p>The dataset can be loaded as follows:</p>
<pre>library(spdep)
library(DClusterm)
data(NY8)</pre>
<p>Given that the interest is in studying the risk of leukemia in upstate New York,
the expected number of cases is computed first. This is done by computing the
overall mortality rate (total cases divided by total population) and
multiplying the population by it:</p>
<pre>rate &lt;- sum(NY8$Cases) / sum(NY8$POP8)
NY8$Expected &lt;- NY8$POP8 * rate</pre>
<p>Once the expected number of cases is obtained, a raw estimate of risk can be
obtained with the <em>standardized mortality ratio</em> (SMR), which is computed as
the number of observed cases divided by the number of expected cases:</p>
<pre>NY8$SMR &lt;- NY8$Cases / NY8$Expected</pre>
<div id="disease-mapping" class="section level3">
<h3>Disease mapping</h3>
<p>In Epidemiology it is important to produce maps to show the spatial distribution
of the relative risk. In this example, we will focus on Syracuse city to reduce
the computation time to produce the map. Hence, we create an index
with the areas in Syracuse city:</p>
<pre># Subset Syracuse city
syracuse &lt;- which(NY8$AREANAME == &quot;Syracuse city&quot;)</pre>
<p>A disease map can be simply created with function <code>spplot</code> (in package
<code>sp</code>):</p>
<pre>library(viridis)
## Loading required package: viridisLite
spplot(NY8[syracuse, ], &quot;SMR&quot;, #at = c(0.6, 0.9801, 1.055, 1.087, 1.125, 13),
   col.regions = rev(magma(16))) #gray.colors(16, 0.9, 0.4))</pre>
<p><img src="https://i0.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png?w=450&#038;ssl=1" data-recalc-dims="1" data-lazy-src="https://i0.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png?w=450&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://i0.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-5-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></noscript></p>
<p>Interactive maps can be easily created with the <code>tmap</code> package:</p>
<pre>library(tmap)
tmap_mode(&quot;view&quot;)

SMR_map &lt;- tm_shape(NY8[syracuse, ]) +
  tm_fill(col = &quot;SMR&quot;, alpha = 0.35) +
  tm_borders() +
  tm_shape(TCE) + tm_dots(col = &quot;red&quot;) # Add TCE sites
widgetframe::frameWidget(print(SMR_map))</pre>
<div id="htmlwidget-1" style="width:100%;height:480px;" class="widgetframe html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"url":"/post/2019-11-05_files/figure-html//widgets/widget_unnamed-chunk-6.html","options":{"xdomain":"*","allowfullscreen":false,"lazyload":false}},"evals":[],"jsHooks":[]}</script>
<p>Note that the previous map also includes the locations of the 11
TCE-contaminated sites and that this can be seen by zooming out.</p>
</div>
</div>
<div id="mixed-effects-models" class="section level2">
<h2>Mixed-effects models</h2>
<div id="poisson-regression" class="section level3">
<h3>Poisson regression</h3>
<p>The first model that we will consider is a Poisson model with no latent random
effects as this will provide a baseline to compare to other models. The model
to fit is:</p>
<p><span class="math display">\[
O_i|\mu_i \sim Po(\mu_i)
\]</span></p>
<p><span class="math display">\[
\mu_i = E_i \theta_i 
\]</span></p>
<p><span class="math display">\[
\log(\theta_i) = \beta_0 + \beta_1 AVGIDIST_i
\]</span></p>
<p>In order to fit the model with <code>INLA</code>, function <code>inla</code> is used:</p>
<pre>library(INLA)
m1 &lt;- inla(Cases ~ 1 + AVGIDIST,
   data = as.data.frame(NY8),
  family = &quot;poisson&quot;,
  E = NY8$Expected, control.predictor = list(compute = TRUE),
  control.compute = list(dic = TRUE, waic = TRUE))</pre>
<p>Note that it works similarly to the <code>glm</code> function. Here, argument
<code>E</code> is used for the expected number of cases. Alternatively, they could
enter the linear predictor in the log-scale as an offset.
Other arguments are set to compute the marginals of the model parameters
(with <code>control.predictor</code>) and to compute some model choice criteria
(with <code>control.compute</code>).</p>
<p>Next, the summary of the model can be obtained:</p>
<pre>summary(m1)
## 
## Call:
##    c(&quot;inla(formula = Cases ~ 1 + AVGIDIST, family = \&quot;poisson\&quot;, data 
##    = as.data.frame(NY8), &quot;, &quot; E = NY8$Expected, control.compute = 
##    list(dic = TRUE, waic = TRUE), &quot;, &quot; control.predictor = 
##    list(compute = TRUE))&quot;) 
## Time used:
##     Pre = 0.368, Running = 0.0968, Post = 0.0587, Total = 0.524 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -0.065 0.045     -0.155   -0.065      0.023 -0.064   0
## AVGIDIST     0.320 0.078      0.160    0.322      0.465  0.327   0
## 
## Expected number of effective parameters(stdev): 2.00(0.00)
## Number of equivalent replicates : 140.25 
## 
## Deviance Information Criterion (DIC) ...............: 948.12
## Deviance Information Criterion (DIC, saturated) ....: 418.75
## Effective number of parameters .....................: 2.00
## 
## Watanabe-Akaike information criterion (WAIC) ...: 949.03
## Effective number of parameters .................: 2.67
## 
## Marginal log-Likelihood:  -480.28 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</pre>
</div>
<div id="poisson-regression-with-random-effects" class="section level3">
<h3>Poisson regression with random effects</h3>
<p>Latent random effects can be added to the model to account for overdispersion
by including i.i.d. Gaussian random effects in the linear predictor, as
follows:</p>
<p><span class="math display">\[
O_i|\mu_i \sim Po(\mu_i)
\]</span></p>
<p><span class="math display">\[
\mu_i = E_i \theta_i 
\]</span></p>
<p><span class="math display">\[
\log(\theta_i) = \beta_0 + \beta_1 AVGIDIST_i + u_i
\]</span></p>
<p><span class="math display">\[
u_i \sim N(0, \tau)
\]</span></p>
<p>In order to fit the model with <code>INLA</code> an index to identify
the random effects (<code>ID</code>) is created first. Latent random effects
are specified with the <code>f</code>-function in <code>INLA</code>:</p>
<pre>NY8$ID &lt;- 1:nrow(NY8)
m2 &lt;- inla(Cases ~ 1 + AVGIDIST + f(ID, model = &quot;iid&quot;),
  data = as.data.frame(NY8), family = &quot;poisson&quot;, 
  E = NY8$Expected,
  control.predictor = list(compute = TRUE),
  control.compute = list(dic = TRUE, waic = TRUE))</pre>
<p>Now the summary of the mode includes information about the random effects:</p>
<pre>summary(m2)
## 
## Call:
##    c(&quot;inla(formula = Cases ~ 1 + AVGIDIST + f(ID, model = \&quot;iid\&quot;), 
##    family = \&quot;poisson\&quot;, &quot;, &quot; data = as.data.frame(NY8), E = 
##    NY8$Expected, control.compute = list(dic = TRUE, &quot;, &quot; waic = 
##    TRUE), control.predictor = list(compute = TRUE))&quot; ) 
## Time used:
##     Pre = 0.236, Running = 0.315, Post = 0.0744, Total = 0.625 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -0.126 0.064     -0.256   -0.125     -0.006 -0.122   0
## AVGIDIST     0.347 0.105      0.139    0.346      0.558  0.344   0
## 
## Random effects:
##   Name     Model
##     ID IID model
## 
## Model hyperparameters:
##                     mean       sd 0.025quant 0.5quant 0.975quant mode
## Precision for ID 3712.34 11263.70       3.52     6.94   39903.61 5.18
## 
## Expected number of effective parameters(stdev): 54.95(30.20)
## Number of equivalent replicates : 5.11 
## 
## Deviance Information Criterion (DIC) ...............: 926.93
## Deviance Information Criterion (DIC, saturated) ....: 397.56
## Effective number of parameters .....................: 61.52
## 
## Watanabe-Akaike information criterion (WAIC) ...: 932.63
## Effective number of parameters .................: 57.92
## 
## Marginal log-Likelihood:  -478.93 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</pre>
</div>
<div id="add-point-estimates-for-mapping" class="section level3">
<h3>Add point estimates for mapping</h3>
<p>The posterior means estimated with these two models can be added to
the <code>SpatialPolygonsDataFrame</code> <code>NY8</code> to be plotted later:</p>
<pre>NY8$FIXED.EFF &lt;- m1$summary.fitted[, &quot;mean&quot;]
NY8$IID.EFF &lt;- m2$summary.fitted[, &quot;mean&quot;]
spplot(NY8[syracuse, ], c(&quot;SMR&quot;, &quot;FIXED.EFF&quot;, &quot;IID.EFF&quot;),
  col.regions = rev(magma(16)))</pre>
<p><img src="https://i2.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-12-1.png?w=450&#038;ssl=1" data-recalc-dims="1" data-lazy-src="https://i2.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-12-1.png?w=450&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://i2.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-12-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></noscript></p>
<p>Note how the model smooths the relative risk.</p>
</div>
</div>
<div id="spatial-models-for-lattice-data" class="section level2">
<h2>Spatial Models for Lattice Data</h2>
<p>Lattice data involves data measured at different areas, e.g.,
neighborhoods, cities, provinces, states, etc. Spatial dependence appears because neighbor areas will show similar
values of the variable of interest.</p>
<div id="models-for-lattice-data" class="section level3">
<h3>Models for lattice data</h3>
<p>We have observations <span class="math inline">\(y=\{y_i\}_{i=1}^n\)</span> from the <span class="math inline">\(n\)</span> areas. <span class="math inline">\(\mathbf{y}\)</span> is
assigned a multivariate distribution that <em>accounts for spatial dependence</em>. A
common way of describing spatial proximity in lattice data is by means of an
adjacency matrix <span class="math inline">\(W\)</span>. Element <span class="math inline">\(W_{i, j}\)</span> is non-zero if areas <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are
neighbors. Usually, two areas are neighbors if they share a common boundary.
There are other definitions of neighborhood (see Bivand et al., 2013).</p>
</div>
<div id="adjacency-matrix" class="section level3">
<h3>Adjacency matrix</h3>
<p>The adjacency matrix can be computed using function <code>poly2nb</code> in package
<code>spdep</code>. This function will consider two areas as neighbors if their borders
touch at least in one point (i.e., <em>queen</em> adjacency):</p>
<pre>NY8.nb &lt;- poly2nb(NY8)</pre>
<p>This will return an <code>nb</code> object with the definition of the neighborhood structure:</p>
<pre>NY8.nb
## Neighbour list object:
## Number of regions: 281 
## Number of nonzero links: 1624 
## Percentage nonzero weights: 2.056712 
## Average number of links: 5.779359</pre>
<p>In addition, <code>nb</code> objects can be plot when the centroids of the polygons are
known:</p>
<pre>plot(NY8) 
plot(NY8.nb, coordinates(NY8), add = TRUE, pch = &quot;.&quot;, col = &quot;gray&quot;)</pre>
<p><img src="https://i1.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-15-1.png?w=450&#038;ssl=1" data-recalc-dims="1" data-lazy-src="https://i1.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-15-1.png?w=450&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://i1.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-15-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></noscript></p>
</div>
</div>
<div id="regression-models" class="section level2">
<h2>Regression models</h2>
<p>It is often the case that, in addition to <span class="math inline">\(y_i\)</span>, we have a number of covariates
<span class="math inline">\(X_i\)</span>. Hence, we may want to <em>regress</em> <span class="math inline">\(y_i\)</span> on <span class="math inline">\(X_i\)</span>. In addition to the
covariates we may want to account for the spatial structure of the data.
Different types of regression models can be used to model lattice data:</p>
<ul>
<li>Generalized Linear Models (with spatial random effects).</li>
<li>Spatial econometrics models.</li>
</ul>
<div id="linear-mixed-models" class="section level3">
<h3>Linear Mixed Models</h3>
<p>A common approach (for Gaussian data) is to use a linear
regression with random effects:</p>
<p><span class="math display">\[
Y =  X \beta+ Zu +\varepsilon 
\]</span></p>
<p>The vector of random effects <span class="math inline">\(u\)</span> is modeled as a multivariate Normal distribution:</p>
<p><span class="math display">\[
u \sim N(0, \sigma^2_u \Sigma)
\]</span></p>
<p><span class="math inline">\(\Sigma\)</span> is defined such as it induces higher correlation with adjacent areas, <span class="math inline">\(Z\)</span> is a design matrix for the random effects and
<span class="math inline">\(\varepsilon_i \sim N(0, \sigma^2), i=1, \ldots, n\)</span> is an error term.</p>
<p>Generalized Linear Mixed Models can be defined in a similar way by using a
different likelihood and linking the appropriate parameter to the linear
predictor.</p>
</div>
<div id="structure-of-spatial-random-effects" class="section level3">
<h3>Structure of spatial random effects</h3>
<p>There are many different ways of including spatial dependence
in <span class="math inline">\(\Sigma\)</span>:</p>
<ul>
<li><em>Simultaneous autoregressive (SAR):</em></li>
</ul>
<p><span class="math display">\[
\Sigma^{-1} = [(I-\rho W)&#39; (I-\rho W)]
\]</span></p>
<ul>
<li><em>Conditional autoregressive (CAR):</em></li>
</ul>
<p><span class="math display">\[
\Sigma^{-1} = (I-\rho W)
\]</span></p>
<ul>
<li><p><em>Intrinsic CAR (ICAR):</em></p>
<p><span class="math display">\[
\Sigma^{-1} = diag(n_i) - W
\]</span></p>
<p><span class="math inline">\(n_i\)</span> is the number of neighbors of area <span class="math inline">\(i\)</span>.</p></li>
<li><p><span class="math inline">\(\Sigma_{i,j}\)</span> depends on a function of <span class="math inline">\(d(i,j)\)</span>. For example:</p></li>
</ul>
<p><span class="math display">\[
\Sigma_{i,j} = \exp\{-d(i,j)/\phi\}
\]</span></p>
<ul>
<li><p>‘Mixture’ of matrices (Leroux et al.’s model):</p>
<p><span class="math display">\[
\Sigma = [(1 - \lambda) I_n + \lambda M]^{-1};\ \lambda \in (0,1)
\]</span></p>
<p><span class="math inline">\(M\)</span> precision of intrinsic CAR specification</p></li>
</ul>
<p>CAR and ICAR specifications have been proposed within the Statistics field,
while the SAR specification was coined within Spatial Econometrics. Regardless
of its origin, all specifications presented here can be regarded as Gaussian
latent effects with a particular precision matrix.</p>
</div>
<div id="icar-model" class="section level3">
<h3>ICAR model</h3>
<p>The first example will be based on the ICAR specification. Note that the
spatial latent effect is defined using the <code>f</code>-function. This will require
an index to identify the random effects in each area, the type of model
and the adjacency matrix. For this, a sparse matrix will be used.</p>
<pre># Create sparse adjacency matrix
NY8.mat &lt;- as(nb2mat(NY8.nb, style = &quot;B&quot;), &quot;Matrix&quot;)
# Fit model
m.icar &lt;- inla(Cases ~ 1 +  AVGIDIST + 
    f(ID, model = &quot;besag&quot;, graph = NY8.mat),
  data = as.data.frame(NY8), E = NY8$Expected, family =&quot;poisson&quot;,
  control.predictor = list(compute = TRUE),
  control.compute = list(dic = TRUE, waic = TRUE))
summary(m.icar)
## 
## Call:
##    c(&quot;inla(formula = Cases ~ 1 + AVGIDIST + f(ID, model = \&quot;besag\&quot;, 
##    &quot;, &quot; graph = NY8.mat), family = \&quot;poisson\&quot;, data = 
##    as.data.frame(NY8), &quot;, &quot; E = NY8$Expected, control.compute = 
##    list(dic = TRUE, waic = TRUE), &quot;, &quot; control.predictor = 
##    list(compute = TRUE))&quot;) 
## Time used:
##     Pre = 0.298, Running = 0.305, Post = 0.0406, Total = 0.644 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -0.122 0.052     -0.226   -0.122     -0.022 -0.120   0
## AVGIDIST     0.318 0.121      0.075    0.320      0.551  0.324   0
## 
## Random effects:
##   Name     Model
##     ID Besags ICAR model
## 
## Model hyperparameters:
##                  mean   sd 0.025quant 0.5quant 0.975quant mode
## Precision for ID 3.20 1.67       1.41     2.79       7.56 2.27
## 
## Expected number of effective parameters(stdev): 46.68(12.67)
## Number of equivalent replicates : 6.02 
## 
## Deviance Information Criterion (DIC) ...............: 904.12
## Deviance Information Criterion (DIC, saturated) ....: 374.75
## Effective number of parameters .....................: 48.31
## 
## Watanabe-Akaike information criterion (WAIC) ...: 906.77
## Effective number of parameters .................: 44.27
## 
## Marginal log-Likelihood:  -685.70 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</pre>
</div>
<div id="bym-model" class="section level3">
<h3>BYM model</h3>
<p>The Besag, York and Mollié model includes two latent random effects: an ICAR
latent effect and a Gaussian iid latent effect. The linear predictor <span class="math inline">\(\eta_i\)</span>
is:</p>
<p><span class="math display">\[
\eta_i = \alpha + \beta AVGIDIST_i + u_i + v_i
\]</span></p>
<ul>
<li><span class="math inline">\(u_i\)</span> is an i.i.d. Gaussian random effect</li>
<li><span class="math inline">\(v_i\)</span> is an intrinsic CAR random effect</li>
</ul>
<p>There is no need
to define these two latent effects if <code>model</code> is set to <code>&quot;bym&quot;</code> when
the latent random effect is defined with the <code>f</code> function.</p>
<pre>m.bym = inla(Cases ~ 1 +  AVGIDIST + 
    f(ID, model = &quot;bym&quot;, graph = NY8.mat),
  data = as.data.frame(NY8), E = NY8$Expected, family =&quot;poisson&quot;,
  control.predictor = list(compute = TRUE),
  control.compute = list(dic = TRUE, waic = TRUE))
summary(m.bym)
## 
## Call:
##    c(&quot;inla(formula = Cases ~ 1 + AVGIDIST + f(ID, model = \&quot;bym\&quot;, 
##    graph = NY8.mat), &quot;, &quot; family = \&quot;poisson\&quot;, data = 
##    as.data.frame(NY8), E = NY8$Expected, &quot;, &quot; control.compute = 
##    list(dic = TRUE, waic = TRUE), control.predictor = list(compute = 
##    TRUE))&quot; ) 
## Time used:
##     Pre = 0.294, Running = 1, Post = 0.0652, Total = 1.36 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld
## (Intercept) -0.123 0.052     -0.227   -0.122     -0.023 -0.121   0
## AVGIDIST     0.318 0.121      0.075    0.320      0.551  0.324   0
## 
## Random effects:
##   Name     Model
##     ID BYM model
## 
## Model hyperparameters:
##                                         mean      sd 0.025quant 0.5quant
## Precision for ID (iid component)     1790.06 1769.02     115.76  1265.24
## Precision for ID (spatial component)    3.12    1.36       1.37     2.82
##                                      0.975quant   mode
## Precision for ID (iid component)        6522.28 310.73
## Precision for ID (spatial component)       6.58   2.33
## 
## Expected number of effective parameters(stdev): 47.66(12.79)
## Number of equivalent replicates : 5.90 
## 
## Deviance Information Criterion (DIC) ...............: 903.41
## Deviance Information Criterion (DIC, saturated) ....: 374.04
## Effective number of parameters .....................: 48.75
## 
## Watanabe-Akaike information criterion (WAIC) ...: 906.61
## Effective number of parameters .................: 45.04
## 
## Marginal log-Likelihood:  -425.65 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</pre>
</div>
<div id="leroux-et-al.model" class="section level3">
<h3>Leroux et al. model</h3>
<p>This model is defined using a ‘mixture’ of matrices (Leroux et al.’s model)
to define the precision matrix of the latent effect:</p>
<p><span class="math display">\[
\Sigma^{-1} = [(1 - \lambda) I_n + \lambda M];\ \lambda \in (0,1)
\]</span></p>
<p>Here, <span class="math inline">\(M\)</span> precision of intrinsic CAR specification.</p>
<p>This model is implemented using the <code>generic1</code> latent effect, which
uses the following precision matrix:</p>
<p><span class="math display">\[
\Sigma^{-1} = \frac{1}{\tau}(I_n-\frac{\rho}{\lambda_{max}}C); \rho \in [0,1)
\]</span></p>
<p>Here, <span class="math inline">\(C\)</span> is a matrix and <span class="math inline">\(\lambda_{max}\)</span> its maximum eigenvalue.</p>
<p>In order to define the right model, we should take matrix <span class="math inline">\(C\)</span> as follows:</p>
<p><span class="math display">\[
C = I_n - M;\ M = diag(n_i) - W
\]</span></p>
<p>Then, <span class="math inline">\(\lambda_{max} = 1\)</span> and</p>
<p><span class="math display">\[
\Sigma^{-1} = 
\frac{1}{\tau}(I_n-\frac{\rho}{\lambda_{max}}C) = 
  \frac{1}{\tau}(I_n-\rho(I_n - M)) = \frac{1}{\tau}((1-\rho) I_n + \rho M)
\]</span></p>
<p>To fit the model, the first step is to create matrix <span class="math inline">\(M\)</span>:</p>
<pre>ICARmatrix &lt;- Diagonal(nrow(NY8.mat), apply(NY8.mat, 1, sum)) - NY8.mat
Cmatrix &lt;- Diagonal(nrow(NY8), 1) -  ICARmatrix</pre>
<p>We can check that the maximum eigenvalue, <span class="math inline">\(\lambda_{max}\)</span>, is one:</p>
<pre>max(eigen(Cmatrix)$values)
## [1] 1</pre>
<p>The model is fit as usual with function <code>inla</code>. Note that the <span class="math inline">\(C\)</span> matrix
is passed to the <code>f</code> function using argument <code>Cmatrix</code>:</p>
<pre>m.ler = inla(Cases ~ 1 +  AVGIDIST +
    f(ID, model = &quot;generic1&quot;, Cmatrix = Cmatrix),
  data = as.data.frame(NY8), E = NY8$Expected, family =&quot;poisson&quot;,
  control.predictor = list(compute = TRUE),
  control.compute = list(dic = TRUE, waic = TRUE))
summary(m.ler)
## 
## Call:
##    c(&quot;inla(formula = Cases ~ 1 + AVGIDIST + f(ID, model = 
##    \&quot;generic1\&quot;, &quot;, &quot; Cmatrix = Cmatrix), family = \&quot;poisson\&quot;, data 
##    = as.data.frame(NY8), &quot;, &quot; E = NY8$Expected, control.compute = 
##    list(dic = TRUE, waic = TRUE), &quot;, &quot; control.predictor = 
##    list(compute = TRUE))&quot;) 
## Time used:
##     Pre = 0.236, Running = 0.695, Post = 0.0493, Total = 0.98 
## Fixed effects:
##               mean    sd 0.025quant 0.5quant 0.975quant   mode   kld
## (Intercept) -0.128 0.448      -0.91   -0.128      0.656 -0.126 0.075
## AVGIDIST     0.325 0.122       0.08    0.327      0.561  0.330 0.000
## 
## Random effects:
##   Name     Model
##     ID Generic1 model
## 
## Model hyperparameters:
##                   mean    sd 0.025quant 0.5quant 0.975quant  mode
## Precision for ID 2.720 1.098       1.27    2.489      5.480 2.106
## Beta for ID      0.865 0.142       0.47    0.915      0.997 0.996
## 
## Expected number of effective parameters(stdev): 52.25(13.87)
## Number of equivalent replicates : 5.38 
## 
## Deviance Information Criterion (DIC) ...............: 903.14
## Deviance Information Criterion (DIC, saturated) ....: 373.77
## Effective number of parameters .....................: 53.12
## 
## Watanabe-Akaike information criterion (WAIC) ...: 906.20
## Effective number of parameters .................: 48.19
## 
## Marginal log-Likelihood:  -474.94 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</pre>
</div>
</div>
<div id="spatial-econometrics-models" class="section level2">
<h2>Spatial Econometrics Models</h2>
<p>Spatial econometrics have been developed following a slightly different
approach to spatial modeling. Instead of using latent effects, spatial
dependence is modeled explicitly. Autoregressive models are used to make the
response variable to depend on the values of its neighbors.</p>
<div id="simultaneous-autoregressive-model-sem" class="section level3">
<h3>Simultaneous Autoregressive Model (SEM)</h3>
<p>This model includes covariates and an autoregressive on the <strong>error term</strong>:</p>
<p><span class="math display">\[
y= X \beta+u; u=\rho Wu+e; e\sim N(0, \sigma^2)
\]</span></p>
<p><span class="math display">\[
y= X \beta + \varepsilon; \varepsilon\sim N(0, \sigma^2 (I-\rho W)^{-1} (I-\rho W&#39;)^{-1})
\]</span></p>
</div>
<div id="spatial-lag-model-slm" class="section level3">
<h3>Spatial Lag Model (SLM)</h3>
<p>This model includes covariates and an autoregressive on the <strong>response</strong>:</p>
<p><span class="math display">\[
y = \rho W y + X \beta + e; e\sim N(0, \sigma^2)
\]</span></p>
<p><span class="math display">\[
y = (I-\rho W)^{-1}X\beta+\varepsilon;\ \varepsilon \sim N(0, \sigma^2(I-\rho W)^{-1} (I-\rho W&#39;)^{-1})
\]</span></p>
</div>
<div id="new-slm-latent-class" class="section level3">
<h3>New <code>slm</code> Latent Class</h3>
<p><code>R-INLA</code> includes now an <em>experimental</em> new latent effect called <code>slm</code> to
fit the following model:</p>
<p><span class="math display">\[
\mathbf{x}= (I_n-\rho W)^{-1} (X\beta +e)
\]</span></p>
<p>The elements of this model are:</p>
<ul>
<li><span class="math inline">\(W\)</span> is a row-standardized adjacency matrix.</li>
<li><span class="math inline">\(\rho\)</span> is a spatial autocorrelation parameter.</li>
<li><span class="math inline">\(X\)</span> is a matrix of covariates, with coefficients <span class="math inline">\(\beta\)</span>.</li>
<li><span class="math inline">\(e\)</span> are Gaussian i.i.d. errors with variance <span class="math inline">\(\sigma^2\)</span>.</li>
</ul>
<p>The <code>slm</code> latent effect is <strong>experimental</strong> and it can be
combined with other effects in the linear predictor</p>
<p>Spatial econometrics models can be fit with the <code>slm</code> latent
effect by noting that the SME and SLM can be defined as:</p>
<ul>
<li><strong>SEM</strong></li>
</ul>
<p><span class="math display">\[
y= X \beta + (I-\rho W)^{-1} (0+e);\ e \sim N(0, \sigma^2 I)
\]</span></p>
<ul>
<li><strong>SLM</strong></li>
</ul>
<p><span class="math display">\[
y = (I-\rho W)^{-1}(X\beta+e);\ e \sim N(0, \sigma^2 I)
\]</span></p>
</div>
<div id="model-definition" class="section level3">
<h3>Model definition</h3>
<p>In order to define a model, we need:</p>
<ul>
<li><code>X</code>: Matrix of covariates</li>
<li><code>W</code>: <strong>Row-standardized</strong> adjacency matrix</li>
<li><code>Q</code>: Precision matrix of coefficients <span class="math inline">\(\beta\)</span></li>
<li>Range of <span class="math inline">\(\rho\)</span>, often defined by the eigenvalues</li>
</ul>
<pre>#X
mmatrix &lt;- model.matrix(Cases ~ 1 + AVGIDIST, NY8)

#W
W &lt;- as(nb2mat(NY8.nb, style = &quot;W&quot;), &quot;Matrix&quot;)

#Q
Q.beta = Diagonal(n = ncol(mmatrix), x = 0.001)

#Range of rho
rho.min&lt;- -1
rho.max&lt;- 1</pre>
<p>The argument of the <code>slm</code> latent effects are passed through argument
<code>args.sm</code>. Here, we have created a list with the same name to keep
all the required values together:</p>
<pre>#Arguments for &#39;slm&#39;
args.slm = list(
   rho.min = rho.min ,
   rho.max = rho.max,
   W = W,
   X = mmatrix,
   Q.beta = Q.beta
)</pre>
<p>In addition, the prior for the precision parameter<span class="math inline">\(\tau\)</span> and the spatial
autocorrelation parameter <span class="math inline">\(\rho\)</span> are set:</p>
<pre>#Prior on rho
hyper.slm = list(
   prec = list(
      prior = &quot;loggamma&quot;, param = c(0.01, 0.01)),
      rho = list(initial=0, prior = &quot;logitbeta&quot;, param = c(1,1))
)</pre>
<p>The prior definition uses a named list with different arguments. Argument
<code>prior</code> defines the prior to use, and <code>param</code> its parameters. Here, the
precision is assigned a gamma prior with parameters <span class="math inline">\(0.01\)</span> and <span class="math inline">\(0.01\)</span>, while
the spatial autocorrelation parameter is given a beta prior with parameters <span class="math inline">\(1\)</span>
and <span class="math inline">\(1\)</span> (i.e., a uniform prior in the interval <span class="math inline">\((1, 1)\)</span>).</p>
</div>
<div id="model-fitting" class="section level3">
<h3>Model fitting</h3>
<pre>#SLM model
m.slm &lt;- inla( Cases ~ -1 +
     f(ID, model = &quot;slm&quot;, args.slm = args.slm, hyper = hyper.slm),
   data = as.data.frame(NY8), family = &quot;poisson&quot;,
   E = NY8$Expected,
   control.predictor = list(compute = TRUE),
   control.compute = list(dic = TRUE, waic = TRUE)
)
## Warning in inla.model.properties.generic(inla.trim.family(model), (mm[names(mm) == : Model &#39;slm&#39; in section &#39;latent&#39; is marked as &#39;experimental&#39;; changes may appear at any time.
##   Use this model with extra care!!! Further warnings are disabled.
summary(m.slm)
## 
## Call:
##    c(&quot;inla(formula = Cases ~ -1 + f(ID, model = \&quot;slm\&quot;, args.slm = 
##    args.slm, &quot;, &quot; hyper = hyper.slm), family = \&quot;poisson\&quot;, data = 
##    as.data.frame(NY8), &quot;, &quot; E = NY8$Expected, control.compute = 
##    list(dic = TRUE, waic = TRUE), &quot;, &quot; control.predictor = 
##    list(compute = TRUE))&quot;) 
## Time used:
##     Pre = 0.265, Running = 1.2, Post = 0.058, Total = 1.52 
## Random effects:
##   Name     Model
##     ID SLM model
## 
## Model hyperparameters:
##                   mean    sd 0.025quant 0.5quant 0.975quant  mode
## Precision for ID 8.989 4.115      3.709    8.085     19.449 6.641
## Rho for ID       0.822 0.073      0.653    0.832      0.936 0.854
## 
## Expected number of effective parameters(stdev): 62.82(15.46)
## Number of equivalent replicates : 4.47 
## 
## Deviance Information Criterion (DIC) ...............: 902.32
## Deviance Information Criterion (DIC, saturated) ....: 372.95
## Effective number of parameters .....................: 64.13
## 
## Watanabe-Akaike information criterion (WAIC) ...: 905.19
## Effective number of parameters .................: 56.12
## 
## Marginal log-Likelihood:  -477.30 
## Posterior marginals for the linear predictor and
##  the fitted values are computed</pre>
<p>Estimates of the coefficients appear as part of the random effects:</p>
<pre>round(m.slm$summary.random$ID[47:48,], 4)
##    ID   mean     sd 0.025quant 0.5quant 0.975quant   mode kld
## 47 47 0.4634 0.3107    -0.1618   0.4671     1.0648 0.4726   0
## 48 48 0.2606 0.3410    -0.4583   0.2764     0.8894 0.3063   0</pre>
<p>Spatial autocorrelation is reported in the internal scale (i.e., between
0 and 1) and needs to be re-scaled:</p>
<pre>marg.rho.internal &lt;- m.slm$marginals.hyperpar[[&quot;Rho for ID&quot;]]
marg.rho &lt;- inla.tmarginal( function(x) {
  rho.min + x * (rho.max - rho.min)
}, marg.rho.internal)

inla.zmarginal(marg.rho, FALSE)
## Mean            0.644436 
## Stdev           0.145461 
## Quantile  0.025 0.309507 
## Quantile  0.25  0.556851 
## Quantile  0.5   0.663068 
## Quantile  0.75  0.752368 
## Quantile  0.975 0.869702
plot(marg.rho, type = &quot;l&quot;, main = &quot;Spatial autocorrelation&quot;)</pre>
<p><img src="https://i1.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-31-1.png?w=450&#038;ssl=1" data-recalc-dims="1" data-lazy-src="https://i1.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-31-1.png?w=450&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://i1.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-31-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></noscript></p>
</div>
</div>
<div id="summary-of-results" class="section level2">
<h2>Summary of results</h2>
<pre>NY8$ICAR &lt;- m.icar$summary.fitted.values[, &quot;mean&quot;]
NY8$BYM &lt;- m.bym$summary.fitted.values[, &quot;mean&quot;]
NY8$LEROUX &lt;- m.ler$summary.fitted.values[, &quot;mean&quot;]
NY8$SLM &lt;- m.slm$summary.fitted.values[, &quot;mean&quot;]
spplot(NY8[syracuse, ], 
  c(&quot;FIXED.EFF&quot;, &quot;IID.EFF&quot;, &quot;ICAR&quot;, &quot;BYM&quot;, &quot;LEROUX&quot;, &quot;SLM&quot;),
  col.regions = rev(magma(16))
)</pre>
<p><img src="https://i2.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-33-1.png?w=450&#038;ssl=1" data-recalc-dims="1" data-lazy-src="https://i2.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-33-1.png?w=450&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://i2.wp.com/codingclubuc3m.rbind.io/post/2019-11-05_files/figure-html/unnamed-chunk-33-1.png?w=450&#038;ssl=1" data-recalc-dims="1" /></noscript></p>
<p>Note how spatial models produce smoother estimates of the relative risk.</p>
<p>In order to choose the best model, the model selection criteria computed
above can be used:</p>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Marg. Lik.</th>
<th align="right">DIC</th>
<th align="right">WAIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>FIXED</td>
<td align="right">-480.2814</td>
<td align="right">948.1198</td>
<td align="right">949.0287</td>
</tr>
<tr class="even">
<td>IID</td>
<td align="right">-478.6043</td>
<td align="right">926.9295</td>
<td align="right">932.6333</td>
</tr>
<tr class="odd">
<td>ICAR</td>
<td align="right">-685.6478</td>
<td align="right">904.1253</td>
<td align="right">906.7689</td>
</tr>
<tr class="even">
<td>BYM</td>
<td align="right">-425.2479</td>
<td align="right">903.4114</td>
<td align="right">906.6138</td>
</tr>
<tr class="odd">
<td>LEROUX</td>
<td align="right">-474.4091</td>
<td align="right">903.1453</td>
<td align="right">906.1948</td>
</tr>
<tr class="even">
<td>SLM</td>
<td align="right">-476.8145</td>
<td align="right">902.3201</td>
<td align="right">905.1892</td>
</tr>
</tbody>
</table>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>Bivand, R., E. Pebesma and V. Gómez-Rubio (2013). <em>Applied spatial data
analysis with R</em>. Springer-Verlag. New York.</p>
<p>Gómez-Rubio, V. (2020). Bayesian inference with INLA. CRC Press. Boca Raton,
FL. <a href="https://becarioprecario.bitbucket.io/inla-gitbook" rel="nofollow" target="_blank">https://becarioprecario.bitbucket.io/inla-gitbook</a></p>
<p>Rue, H., S. Martino and N. Chopin (2009). <em>Approximate bayesian inference for
latent Gaussian models by using integrated nested Laplace approximations</em>.
Journal of the royal statistical society: Series B (statistical methodology)
71(2): 319–392.</p>
<p>Waller, L. A. and C. A. Gotway (2004). Applied spatial statistics for public
health data. John Wiley & Sons, Inc. Hoboken, New Jersey.</p>
</div>

      
<script type="376714593608de8c39e32b38-text/javascript">
    var vglnk = {key: '949efb41171ac6ec1bf7f206d57e90b8'};
    (function(d, t) {
        var s = d.createElement(t);
            s.type = 'text/javascript';
            s.async = true;
			// s.defer = true;
//          s.src = '//cdn.viglink.com/api/vglnk.js'; 
			s.src = 'https://www.r-bloggers.com/wp-content/uploads/2020/08/vglnk.js';
        var r = d.getElementsByTagName(t)[0];
            r.parentNode.insertBefore(s, r);
    }(document, 'script'));
</script>
		
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div><aside class="mashsb-container mashsb-main mashsb-stretched"><div class="mashsb-box"><div class="mashsb-buttons"><a class="mashicon-facebook mash-large mash-center mashsb-noshadow" href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fwww.r-bloggers.com%2F2019%2F11%2Fspatial-data-analysis-with-inla%2F" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Share</span></a><a class="mashicon-twitter mash-large mash-center mashsb-noshadow" href="https://twitter.com/intent/tweet?text=Spatial%20Data%20Analysis%20with%20INLA&url=https://www.r-bloggers.com/2019/11/spatial-data-analysis-with-inla/&via=Rbloggers" target="_blank" rel="nofollow"><span class="icon"></span><span class="text">Tweet</span></a><div class="onoffswitch2 mash-large mashsb-noshadow" style="display:none;"></div></div>
            </div>
                <div style="clear:both;"></div></aside>
            <!-- Share buttons by mashshare.net - Version: 3.8.0-->
<p class="syndicated-attribution"><div style="border: 1px solid; background: none repeat scroll 0 0 #EDEDED; margin: 1px; font-size: 13px;">
<div style="text-align: center;">To <strong>leave a comment</strong> for the author, please follow the link and comment on their blog: <strong><a href="https://codingclubuc3m.rbind.io/post/2019-11-05/"> R on Coding Club UC3M</a></strong>.</div>
<hr />
<a href="https://www.r-bloggers.com/" rel="nofollow">R-bloggers.com</a> offers <strong><a href="https://feedburner.google.com/fb/a/mailverify?uri=RBloggers" rel="nofollow">daily e-mail updates</a></strong> about <a title="The R Project for Statistical Computing" href="https://www.r-project.org/" rel="nofollow">R</a> news and tutorials about <a title="R tutorials" href="https://www.r-bloggers.com/how-to-learn-r-2/" rel="nofollow">learning R</a> and many other topics. <a title="Data science jobs" href="https://www.r-users.com/" rel="nofollow">Click here if you're looking to post or find an R/data-science job</a>.

<hr>Want to share your content on R-bloggers?<a href="https://www.r-bloggers.com/add-your-blog/" rel="nofollow"> click here</a> if you have a blog, or <a href="https://r-posts.com/" rel="nofollow"> here</a> if you don't.
</div></p>			</div>
	</article><nav class="post-navigation clearfix" role="navigation">
<div class="post-nav left">
<a href="https://www.r-bloggers.com/2019/11/data-scientist-or-data-engineer-whats-the-difference/" rel="prev">&larr; Previous post</a></div>
<div class="post-nav right">
<a href="https://www.r-bloggers.com/2019/11/data-science-on-rails-analyzing-customer-churn/" rel="next">Next post &rarr;</a></div>
</nav>
	</div>
	<aside class="mh-sidebar sb-right">
	<div id="custom_html-2" class="widget_text sb-widget widget_custom_html"><div class="textwidget custom-html-widget">
<div class="top-search" style="padding-left: 0px;">
	<form id="searchform" action="https://www.google.com/cse" target="_blank">
		<div>
			<input type="hidden" name="cx" value="005359090438081006639:paz69t-s8ua" />
			<input type="hidden" name="ie" value="UTF-8" />
			<input type="text" value="" name="q" id="q" autocomplete="on" style="font-size:16px;" placeholder="Search R-bloggers.." />
			<input type="submit" id="searchsubmit2" name="sa" value="Go" style="font-size:16px;" />
		</div>
	</form>

</div>
<!-- thanks: https://stackoverflow.com/questions/14981575/google-cse-with-a-custom-form 
https://stackoverflow.com/questions/10363674/change-size-of-text-in-text-input-tag
--></div></div><div id="text-6" class="sb-widget widget_text">			<div class="textwidget"><div style="min-height:26px;border:1px solid #ccc;padding:3px;text-align:left; background: none repeat scroll 0 0 #FDEADA;">

<form  style="width:202px; float:left;" action="https://r-bloggers.com/phplist/?p=subscribe&id=1" method="post" target="popupwindow">

<input type="text" style="width:110px" onclick="if (!window.__cfRLUnblockHandlers) return false; if (this.value == 'Your e-mail here') this.value = '';" value='Your e-mail here' name="email" data-cf-modified-376714593608de8c39e32b38-="" />
<input type="hidden" value="RBloggers" name="uri"/><input type="hidden" name="loc" value="en_US"/><input type="submit" value="Subscribe" />

</form>


<div>
<a href="https://feeds.feedburner.com/RBloggers"><img src="https://i1.wp.com/www.r-bloggers.com/wp-content/uploads/2020/07/RBloggers_feedburner_count_2020_07_01-e1593671704447.gif?w=578&#038;ssl=1" style="height:17px;min-width:80px;class:skip-lazy;" alt data-recalc-dims="1" data-lazy-src="https://i1.wp.com/www.r-bloggers.com/wp-content/uploads/2020/07/RBloggers_feedburner_count_2020_07_01-e1593671704447.gif?w=578&amp;is-pending-load=1#038;ssl=1" srcset="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" class=" jetpack-lazy-image"><noscript><img src="https://i1.wp.com/www.r-bloggers.com/wp-content/uploads/2020/07/RBloggers_feedburner_count_2020_07_01-e1593671704447.gif?w=578&#038;ssl=1" style="height:17px;min-width:80px;class:skip-lazy;" alt="" data-recalc-dims="1" /></noscript></a>
</div>

</div>

<br/>

<div>
<script type="376714593608de8c39e32b38-text/javascript">
function init() {
var vidDefer = document.getElementsByTagName('iframe');
for (var i=0; i<vidDefer.length; i++) {
if(vidDefer[i].getAttribute('data-src')) {
vidDefer[i].setAttribute('src',vidDefer[i].getAttribute('data-src'));
} } }
window.onload = init;
</script>

<iframe allowtransparency="true" frameborder="0" scrolling="no"
src="" data-src="//platform.twitter.com/widgets/follow_button.html?screen_name=rbloggers&data-show-count"
  style="width:100%; height:30px;"></iframe>


<div id="fb-root"></div>
<script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v7.0&appId=124112670941750&autoLogAppEvents=1" nonce="RysU23SE" type="376714593608de8c39e32b38-text/javascript"></script>

<div style="min-height: 154px;" class="fb-page" data-href="https://www.facebook.com/rbloggers/" data-tabs="" data-width="300" data-height="154" data-small-header="true" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"><blockquote cite="https://www.facebook.com/rbloggers/" class="fb-xfbml-parse-ignore"><a href="https://www.facebook.com/rbloggers/">R bloggers Facebook page</a></blockquote></div>



<!--
<iframe src="" data-src="//www.facebook.com/plugins/likebox.php?href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FR-bloggers%2F191414254890&amp;width=300&amp;height=155&amp;show_faces=true&amp;colorscheme=light&amp;stream=false&amp;border_color&amp;header=false&amp;appId=400430016676958" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100%; height:140px;" allowTransparency="true"></iframe>
-->


<!--
<br/>
<strong>If you are an R blogger yourself</strong> you are invited to <a href="https://www.r-bloggers.com/add-your-blog/">add your own R content feed to this site</a> (<strong>Non-English</strong> R bloggers should add themselves- <a href="https://www.r-bloggers.com/lang/add-your-blog">here</a>) -->

</div></div>
		</div><div id="wppp-3" class="sb-widget widget_wppp"><h4 class="widget-title">Most viewed posts (weekly)</h4>
<ul class='wppp_list'>
	<li><a href='https://www.r-bloggers.com/2021/09/introduction-to-machine-learning-with-tensorflow/' title='Introduction to Machine Learning with TensorFlow'>Introduction to Machine Learning with TensorFlow</a></li>
	<li><a href='https://www.r-bloggers.com/2018/07/pca-vs-autoencoders-for-dimensionality-reduction/' title='PCA vs Autoencoders for Dimensionality Reduction'>PCA vs Autoencoders for Dimensionality Reduction</a></li>
	<li><a href='https://www.r-bloggers.com/2016/11/5-ways-to-subset-a-data-frame-in-r/' title='5 Ways to Subset a Data Frame in R'>5 Ways to Subset a Data Frame in R</a></li>
	<li><a href='https://www.r-bloggers.com/2015/12/how-to-write-the-first-for-loop-in-r/' title='How to write the first for loop in R'>How to write the first for loop in R</a></li>
	<li><a href='https://www.r-bloggers.com/2013/08/date-formats-in-r/' title='Date Formats in R'>Date Formats in R</a></li>
	<li><a href='https://www.r-bloggers.com/2020/01/how-to-remove-outliers-in-r/' title='How to Remove Outliers in R'>How to Remove Outliers in R</a></li>
	<li><a href='https://www.r-bloggers.com/2010/02/r-sorting-a-data-frame-by-the-contents-of-a-column/' title='R – Sorting a data frame by the contents of a column'>R – Sorting a data frame by the contents of a column</a></li>
</ul>
</div><div id="text-18" class="sb-widget widget_text"><h4 class="widget-title">Sponsors</h4>			<div class="textwidget"><div style="min-height: 2055px;">

<script data-cfasync="false" type="text/javascript">
// https://support.cloudflare.com/hc/en-us/articles/200169436-How-can-I-have-Rocket-Loader-ignore-my-script-s-in-Automatic-Mode-
// this must be placed higher. Otherwise it doesn't work.
// data-cfasync="false" is for making sure cloudflares' rocketcache doesn't interfeare with this
// in this case it only works because it was used at the original script in the text widget


function createCookie(name,value,days) {
    var expires = "";
    if (days) {
        var date = new Date();
        date.setTime(date.getTime() + (days*24*60*60*1000));
        expires = "; expires=" + date.toUTCString();
    }
    document.cookie = name + "=" + value + expires + "; path=/";
}

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

// no longer use async because of google
// async 
async function readTextFile(file)
{
	// Helps people browse between pages without the need to keep downloading the same 
	// ads txt page everytime. This way, it allows them to use their browser's cache.
	var random_number = readCookie("ad_random_number_cookie");
	if(random_number == null) {
		var random_number = Math.floor(Math.random()*100*(new Date().getTime()/10000000000));
		createCookie("ad_random_number_cookie",random_number,1)
	}
	
    file += '?t='+random_number;
    var rawFile = new XMLHttpRequest();
    rawFile.onreadystatechange = function ()
    {
        if(rawFile.readyState === 4)
        {
            if(rawFile.status === 200 || rawFile.status == 0)
            {
                // var allText = rawFile.responseText;
                // document.write(allText);
                document.write(rawFile.responseText);
            }
        }
    }
    rawFile.open("GET", file, false);
    rawFile.send(null);
}

// readTextFile('https://raw.githubusercontent.com/Raynos/file-store/master/temp.txt');

readTextFile("https://www.r-bloggers.com/wp-content/uploads/text-widget_anti-cache.txt");


</script>

</div></div>
		</div>
		<div id="recent-posts-3" class="sb-widget widget_recent_entries">
		<h4 class="widget-title">Recent Posts</h4>
		<ul>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/introduction-to-deep-learning/">Introduction to Deep Learning</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/a-simple-two-stage-stochastic-linear-programming-using-r/">A Simple Two-Stage Stochastic Linear Programming using R</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/robservations-13-simulating-fsas-in-lieu-of-real-postal-code-data/">RObservations #13: Simulating FSAs in lieu of real postal code data.</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/running-r-code-for-all-combinations-of-some-parameters-with-lapply-karate/">Running R code for all combinations of some parameters with lapply karate</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/error-java_home-cannot-be-determined-from-the-registry/">error: JAVA_HOME cannot be determined from the Registry</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/competition-to-win-free-training-closes-today/">Competition to win free training closes today</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/solving-einsteins-puzzle-with-constraint-programming/">Solving Einstein’s Puzzle with Constraint Programming</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/advancements-in-symbolic-data-analysis/">Advancements in Symbolic Data Analysis</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/using-bootstrapped-sampling-to-assess-variability-in-score-predictions/">Using bootstrapped sampling to assess variability in score predictions</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/an-rstudio-table-contest-for-2021/">An RStudio Table Contest for 2021</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/advances-in-difference-in-differences-in-econometrics/">Advances in Difference-in-Differences in Econometrics</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/optimal-disclosure-risk-assessment/">Optimal disclosure risk assessment</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/ropensci-news-digest-september-2021/">rOpenSci News Digest, September 2021</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/f1-strategy-analysis/">F1 Strategy Analysis</a>
									</li>
											<li>
					<a href="https://www.r-bloggers.com/2021/09/introduction-to-machine-learning-with-tensorflow/">Introduction to Machine Learning with TensorFlow</a>
									</li>
					</ul>

		</div><div id="rss-7" class="sb-widget widget_rss"><h4 class="widget-title"><a class="rsswidget" href="https://feeds.feedburner.com/Rjobs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://www.r-bloggers.com/wp-includes/images/rss.png" alt="RSS" /></a> <a class="rsswidget" href="https://www.r-users.com/">Jobs for R-users</a></h4><ul><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/XUqQfUzxziw/">Junior Data Scientist / Quantitative economist</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/C2KYkXtMCHw/">Senior Quantitative Analyst</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/z5mEr8qKkUI/">R programmer</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/wi3Gfi8GNqA/">Data Scientist – CGIAR Excellence in Agronomy (Ref No: DDG-R4D/DS/1/CG/EA/06/20)</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/RJobs/~3/aSK4JGQQOfg/">Data Analytics Auditor, Future of Audit Lead @ London or Newcastle</a></li></ul></div><div id="rss-9" class="sb-widget widget_rss"><h4 class="widget-title"><a class="rsswidget" href="https://feeds.feedburner.com/Python-bloggers"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://www.r-bloggers.com/wp-includes/images/rss.png" alt="RSS" /></a> <a class="rsswidget" href="https://python-bloggers.com/">python-bloggers.com (python/data-science news)</a></h4><ul><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/l-AKXEY5pqE/">3 Ways To Perform Quick Exploratory Data Analysis in Python</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/wx3KC7T8Hcc/">Using the data algebra for Statistics and Data Science</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/vmsKvVpCp7A/">calmcode.io &gt; video tutorials for open source tools</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/Wr2NNpwSmEM/">Apache Kafka in Python: How to Stream Data With Producers and Consumers</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/PnmqufUf9rQ/">Classification using linear regression</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/AJeqTZup_XU/">Technical skills or business skills… why not both? (Pragmatic Institute blog post)</a></li><li><a class='rsswidget' href="https://feedproxy.google.com/~r/Python-bloggers/~3/VUemwoXSf9M/">Roll up, roll up the NHS-R Community Conference 2021 is coming to town</a></li></ul></div><div id="text-16" class="sb-widget widget_text">			<div class="textwidget"><strong><a href="https://www.r-bloggers.com/blogs-list/">Full list of contributing R-bloggers</a></strong></div>
		</div><div id="archives-3" class="sb-widget widget_archive"><h4 class="widget-title">Archives</h4>		<label class="screen-reader-text" for="archives-dropdown-3">Archives</label>
		<select id="archives-dropdown-3" name="archive-dropdown">
			
			<option value="">Select Month</option>
				<option value='https://www.r-bloggers.com/2021/09/'> September 2021 &nbsp;(184)</option>
	<option value='https://www.r-bloggers.com/2021/08/'> August 2021 &nbsp;(145)</option>
	<option value='https://www.r-bloggers.com/2021/07/'> July 2021 &nbsp;(167)</option>
	<option value='https://www.r-bloggers.com/2021/06/'> June 2021 &nbsp;(195)</option>
	<option value='https://www.r-bloggers.com/2021/05/'> May 2021 &nbsp;(196)</option>
	<option value='https://www.r-bloggers.com/2021/04/'> April 2021 &nbsp;(183)</option>
	<option value='https://www.r-bloggers.com/2021/03/'> March 2021 &nbsp;(215)</option>
	<option value='https://www.r-bloggers.com/2021/02/'> February 2021 &nbsp;(218)</option>
	<option value='https://www.r-bloggers.com/2021/01/'> January 2021 &nbsp;(242)</option>
	<option value='https://www.r-bloggers.com/2020/12/'> December 2020 &nbsp;(284)</option>
	<option value='https://www.r-bloggers.com/2020/11/'> November 2020 &nbsp;(256)</option>
	<option value='https://www.r-bloggers.com/2020/10/'> October 2020 &nbsp;(268)</option>
	<option value='https://www.r-bloggers.com/2020/09/'> September 2020 &nbsp;(242)</option>
	<option value='https://www.r-bloggers.com/2020/08/'> August 2020 &nbsp;(218)</option>
	<option value='https://www.r-bloggers.com/2020/07/'> July 2020 &nbsp;(259)</option>
	<option value='https://www.r-bloggers.com/2020/06/'> June 2020 &nbsp;(227)</option>
	<option value='https://www.r-bloggers.com/2020/05/'> May 2020 &nbsp;(326)</option>
	<option value='https://www.r-bloggers.com/2020/04/'> April 2020 &nbsp;(327)</option>
	<option value='https://www.r-bloggers.com/2020/03/'> March 2020 &nbsp;(279)</option>
	<option value='https://www.r-bloggers.com/2020/02/'> February 2020 &nbsp;(261)</option>
	<option value='https://www.r-bloggers.com/2020/01/'> January 2020 &nbsp;(253)</option>
	<option value='https://www.r-bloggers.com/2019/12/'> December 2019 &nbsp;(244)</option>
	<option value='https://www.r-bloggers.com/2019/11/'> November 2019 &nbsp;(219)</option>
	<option value='https://www.r-bloggers.com/2019/10/'> October 2019 &nbsp;(233)</option>
	<option value='https://www.r-bloggers.com/2019/09/'> September 2019 &nbsp;(233)</option>
	<option value='https://www.r-bloggers.com/2019/08/'> August 2019 &nbsp;(273)</option>
	<option value='https://www.r-bloggers.com/2019/07/'> July 2019 &nbsp;(260)</option>
	<option value='https://www.r-bloggers.com/2019/06/'> June 2019 &nbsp;(245)</option>
	<option value='https://www.r-bloggers.com/2019/05/'> May 2019 &nbsp;(277)</option>
	<option value='https://www.r-bloggers.com/2019/04/'> April 2019 &nbsp;(293)</option>
	<option value='https://www.r-bloggers.com/2019/03/'> March 2019 &nbsp;(308)</option>
	<option value='https://www.r-bloggers.com/2019/02/'> February 2019 &nbsp;(262)</option>
	<option value='https://www.r-bloggers.com/2019/01/'> January 2019 &nbsp;(287)</option>
	<option value='https://www.r-bloggers.com/2018/12/'> December 2018 &nbsp;(257)</option>
	<option value='https://www.r-bloggers.com/2018/11/'> November 2018 &nbsp;(289)</option>
	<option value='https://www.r-bloggers.com/2018/10/'> October 2018 &nbsp;(308)</option>
	<option value='https://www.r-bloggers.com/2018/09/'> September 2018 &nbsp;(291)</option>
	<option value='https://www.r-bloggers.com/2018/08/'> August 2018 &nbsp;(270)</option>
	<option value='https://www.r-bloggers.com/2018/07/'> July 2018 &nbsp;(333)</option>
	<option value='https://www.r-bloggers.com/2018/06/'> June 2018 &nbsp;(298)</option>
	<option value='https://www.r-bloggers.com/2018/05/'> May 2018 &nbsp;(321)</option>
	<option value='https://www.r-bloggers.com/2018/04/'> April 2018 &nbsp;(301)</option>
	<option value='https://www.r-bloggers.com/2018/03/'> March 2018 &nbsp;(291)</option>
	<option value='https://www.r-bloggers.com/2018/02/'> February 2018 &nbsp;(241)</option>
	<option value='https://www.r-bloggers.com/2018/01/'> January 2018 &nbsp;(330)</option>
	<option value='https://www.r-bloggers.com/2017/12/'> December 2017 &nbsp;(261)</option>
	<option value='https://www.r-bloggers.com/2017/11/'> November 2017 &nbsp;(270)</option>
	<option value='https://www.r-bloggers.com/2017/10/'> October 2017 &nbsp;(290)</option>
	<option value='https://www.r-bloggers.com/2017/09/'> September 2017 &nbsp;(294)</option>
	<option value='https://www.r-bloggers.com/2017/08/'> August 2017 &nbsp;(340)</option>
	<option value='https://www.r-bloggers.com/2017/07/'> July 2017 &nbsp;(283)</option>
	<option value='https://www.r-bloggers.com/2017/06/'> June 2017 &nbsp;(317)</option>
	<option value='https://www.r-bloggers.com/2017/05/'> May 2017 &nbsp;(349)</option>
	<option value='https://www.r-bloggers.com/2017/04/'> April 2017 &nbsp;(324)</option>
	<option value='https://www.r-bloggers.com/2017/03/'> March 2017 &nbsp;(365)</option>
	<option value='https://www.r-bloggers.com/2017/02/'> February 2017 &nbsp;(317)</option>
	<option value='https://www.r-bloggers.com/2017/01/'> January 2017 &nbsp;(367)</option>
	<option value='https://www.r-bloggers.com/2016/12/'> December 2016 &nbsp;(347)</option>
	<option value='https://www.r-bloggers.com/2016/11/'> November 2016 &nbsp;(294)</option>
	<option value='https://www.r-bloggers.com/2016/10/'> October 2016 &nbsp;(306)</option>
	<option value='https://www.r-bloggers.com/2016/09/'> September 2016 &nbsp;(254)</option>
	<option value='https://www.r-bloggers.com/2016/08/'> August 2016 &nbsp;(287)</option>
	<option value='https://www.r-bloggers.com/2016/07/'> July 2016 &nbsp;(327)</option>
	<option value='https://www.r-bloggers.com/2016/06/'> June 2016 &nbsp;(263)</option>
	<option value='https://www.r-bloggers.com/2016/05/'> May 2016 &nbsp;(292)</option>
	<option value='https://www.r-bloggers.com/2016/04/'> April 2016 &nbsp;(260)</option>
	<option value='https://www.r-bloggers.com/2016/03/'> March 2016 &nbsp;(302)</option>
	<option value='https://www.r-bloggers.com/2016/02/'> February 2016 &nbsp;(268)</option>
	<option value='https://www.r-bloggers.com/2016/01/'> January 2016 &nbsp;(337)</option>
	<option value='https://www.r-bloggers.com/2015/12/'> December 2015 &nbsp;(304)</option>
	<option value='https://www.r-bloggers.com/2015/11/'> November 2015 &nbsp;(234)</option>
	<option value='https://www.r-bloggers.com/2015/10/'> October 2015 &nbsp;(259)</option>
	<option value='https://www.r-bloggers.com/2015/09/'> September 2015 &nbsp;(238)</option>
	<option value='https://www.r-bloggers.com/2015/08/'> August 2015 &nbsp;(264)</option>
	<option value='https://www.r-bloggers.com/2015/07/'> July 2015 &nbsp;(243)</option>
	<option value='https://www.r-bloggers.com/2015/06/'> June 2015 &nbsp;(213)</option>
	<option value='https://www.r-bloggers.com/2015/05/'> May 2015 &nbsp;(235)</option>
	<option value='https://www.r-bloggers.com/2015/04/'> April 2015 &nbsp;(211)</option>
	<option value='https://www.r-bloggers.com/2015/03/'> March 2015 &nbsp;(259)</option>
	<option value='https://www.r-bloggers.com/2015/02/'> February 2015 &nbsp;(212)</option>
	<option value='https://www.r-bloggers.com/2015/01/'> January 2015 &nbsp;(245)</option>
	<option value='https://www.r-bloggers.com/2014/12/'> December 2014 &nbsp;(236)</option>
	<option value='https://www.r-bloggers.com/2014/11/'> November 2014 &nbsp;(221)</option>
	<option value='https://www.r-bloggers.com/2014/10/'> October 2014 &nbsp;(218)</option>
	<option value='https://www.r-bloggers.com/2014/09/'> September 2014 &nbsp;(259)</option>
	<option value='https://www.r-bloggers.com/2014/08/'> August 2014 &nbsp;(217)</option>
	<option value='https://www.r-bloggers.com/2014/07/'> July 2014 &nbsp;(235)</option>
	<option value='https://www.r-bloggers.com/2014/06/'> June 2014 &nbsp;(241)</option>
	<option value='https://www.r-bloggers.com/2014/05/'> May 2014 &nbsp;(243)</option>
	<option value='https://www.r-bloggers.com/2014/04/'> April 2014 &nbsp;(260)</option>
	<option value='https://www.r-bloggers.com/2014/03/'> March 2014 &nbsp;(289)</option>
	<option value='https://www.r-bloggers.com/2014/02/'> February 2014 &nbsp;(269)</option>
	<option value='https://www.r-bloggers.com/2014/01/'> January 2014 &nbsp;(263)</option>
	<option value='https://www.r-bloggers.com/2013/12/'> December 2013 &nbsp;(264)</option>
	<option value='https://www.r-bloggers.com/2013/11/'> November 2013 &nbsp;(241)</option>
	<option value='https://www.r-bloggers.com/2013/10/'> October 2013 &nbsp;(234)</option>
	<option value='https://www.r-bloggers.com/2013/09/'> September 2013 &nbsp;(215)</option>
	<option value='https://www.r-bloggers.com/2013/08/'> August 2013 &nbsp;(223)</option>
	<option value='https://www.r-bloggers.com/2013/07/'> July 2013 &nbsp;(254)</option>
	<option value='https://www.r-bloggers.com/2013/06/'> June 2013 &nbsp;(272)</option>
	<option value='https://www.r-bloggers.com/2013/05/'> May 2013 &nbsp;(260)</option>
	<option value='https://www.r-bloggers.com/2013/04/'> April 2013 &nbsp;(279)</option>
	<option value='https://www.r-bloggers.com/2013/03/'> March 2013 &nbsp;(277)</option>
	<option value='https://www.r-bloggers.com/2013/02/'> February 2013 &nbsp;(294)</option>
	<option value='https://www.r-bloggers.com/2013/01/'> January 2013 &nbsp;(343)</option>
	<option value='https://www.r-bloggers.com/2012/12/'> December 2012 &nbsp;(308)</option>
	<option value='https://www.r-bloggers.com/2012/11/'> November 2012 &nbsp;(277)</option>
	<option value='https://www.r-bloggers.com/2012/10/'> October 2012 &nbsp;(308)</option>
	<option value='https://www.r-bloggers.com/2012/09/'> September 2012 &nbsp;(270)</option>
	<option value='https://www.r-bloggers.com/2012/08/'> August 2012 &nbsp;(263)</option>
	<option value='https://www.r-bloggers.com/2012/07/'> July 2012 &nbsp;(247)</option>
	<option value='https://www.r-bloggers.com/2012/06/'> June 2012 &nbsp;(298)</option>
	<option value='https://www.r-bloggers.com/2012/05/'> May 2012 &nbsp;(287)</option>
	<option value='https://www.r-bloggers.com/2012/04/'> April 2012 &nbsp;(295)</option>
	<option value='https://www.r-bloggers.com/2012/03/'> March 2012 &nbsp;(304)</option>
	<option value='https://www.r-bloggers.com/2012/02/'> February 2012 &nbsp;(264)</option>
	<option value='https://www.r-bloggers.com/2012/01/'> January 2012 &nbsp;(280)</option>
	<option value='https://www.r-bloggers.com/2011/12/'> December 2011 &nbsp;(251)</option>
	<option value='https://www.r-bloggers.com/2011/11/'> November 2011 &nbsp;(261)</option>
	<option value='https://www.r-bloggers.com/2011/10/'> October 2011 &nbsp;(281)</option>
	<option value='https://www.r-bloggers.com/2011/09/'> September 2011 &nbsp;(187)</option>
	<option value='https://www.r-bloggers.com/2011/08/'> August 2011 &nbsp;(258)</option>
	<option value='https://www.r-bloggers.com/2011/07/'> July 2011 &nbsp;(219)</option>
	<option value='https://www.r-bloggers.com/2011/06/'> June 2011 &nbsp;(225)</option>
	<option value='https://www.r-bloggers.com/2011/05/'> May 2011 &nbsp;(239)</option>
	<option value='https://www.r-bloggers.com/2011/04/'> April 2011 &nbsp;(268)</option>
	<option value='https://www.r-bloggers.com/2011/03/'> March 2011 &nbsp;(249)</option>
	<option value='https://www.r-bloggers.com/2011/02/'> February 2011 &nbsp;(205)</option>
	<option value='https://www.r-bloggers.com/2011/01/'> January 2011 &nbsp;(209)</option>
	<option value='https://www.r-bloggers.com/2010/12/'> December 2010 &nbsp;(188)</option>
	<option value='https://www.r-bloggers.com/2010/11/'> November 2010 &nbsp;(172)</option>
	<option value='https://www.r-bloggers.com/2010/10/'> October 2010 &nbsp;(219)</option>
	<option value='https://www.r-bloggers.com/2010/09/'> September 2010 &nbsp;(185)</option>
	<option value='https://www.r-bloggers.com/2010/08/'> August 2010 &nbsp;(203)</option>
	<option value='https://www.r-bloggers.com/2010/07/'> July 2010 &nbsp;(175)</option>
	<option value='https://www.r-bloggers.com/2010/06/'> June 2010 &nbsp;(167)</option>
	<option value='https://www.r-bloggers.com/2010/05/'> May 2010 &nbsp;(164)</option>
	<option value='https://www.r-bloggers.com/2010/04/'> April 2010 &nbsp;(152)</option>
	<option value='https://www.r-bloggers.com/2010/03/'> March 2010 &nbsp;(165)</option>
	<option value='https://www.r-bloggers.com/2010/02/'> February 2010 &nbsp;(135)</option>
	<option value='https://www.r-bloggers.com/2010/01/'> January 2010 &nbsp;(121)</option>
	<option value='https://www.r-bloggers.com/2009/12/'> December 2009 &nbsp;(126)</option>
	<option value='https://www.r-bloggers.com/2009/11/'> November 2009 &nbsp;(66)</option>
	<option value='https://www.r-bloggers.com/2009/10/'> October 2009 &nbsp;(87)</option>
	<option value='https://www.r-bloggers.com/2009/09/'> September 2009 &nbsp;(65)</option>
	<option value='https://www.r-bloggers.com/2009/08/'> August 2009 &nbsp;(56)</option>
	<option value='https://www.r-bloggers.com/2009/07/'> July 2009 &nbsp;(64)</option>
	<option value='https://www.r-bloggers.com/2009/06/'> June 2009 &nbsp;(54)</option>
	<option value='https://www.r-bloggers.com/2009/05/'> May 2009 &nbsp;(35)</option>
	<option value='https://www.r-bloggers.com/2009/04/'> April 2009 &nbsp;(38)</option>
	<option value='https://www.r-bloggers.com/2009/03/'> March 2009 &nbsp;(40)</option>
	<option value='https://www.r-bloggers.com/2009/02/'> February 2009 &nbsp;(33)</option>
	<option value='https://www.r-bloggers.com/2009/01/'> January 2009 &nbsp;(42)</option>
	<option value='https://www.r-bloggers.com/2008/12/'> December 2008 &nbsp;(16)</option>
	<option value='https://www.r-bloggers.com/2008/11/'> November 2008 &nbsp;(14)</option>
	<option value='https://www.r-bloggers.com/2008/10/'> October 2008 &nbsp;(10)</option>
	<option value='https://www.r-bloggers.com/2008/09/'> September 2008 &nbsp;(8)</option>
	<option value='https://www.r-bloggers.com/2008/08/'> August 2008 &nbsp;(11)</option>
	<option value='https://www.r-bloggers.com/2008/07/'> July 2008 &nbsp;(7)</option>
	<option value='https://www.r-bloggers.com/2008/06/'> June 2008 &nbsp;(8)</option>
	<option value='https://www.r-bloggers.com/2008/05/'> May 2008 &nbsp;(8)</option>
	<option value='https://www.r-bloggers.com/2008/04/'> April 2008 &nbsp;(4)</option>
	<option value='https://www.r-bloggers.com/2008/03/'> March 2008 &nbsp;(5)</option>
	<option value='https://www.r-bloggers.com/2008/02/'> February 2008 &nbsp;(6)</option>
	<option value='https://www.r-bloggers.com/2008/01/'> January 2008 &nbsp;(10)</option>
	<option value='https://www.r-bloggers.com/2007/12/'> December 2007 &nbsp;(3)</option>
	<option value='https://www.r-bloggers.com/2007/11/'> November 2007 &nbsp;(5)</option>
	<option value='https://www.r-bloggers.com/2007/10/'> October 2007 &nbsp;(9)</option>
	<option value='https://www.r-bloggers.com/2007/09/'> September 2007 &nbsp;(7)</option>
	<option value='https://www.r-bloggers.com/2007/08/'> August 2007 &nbsp;(21)</option>
	<option value='https://www.r-bloggers.com/2007/07/'> July 2007 &nbsp;(9)</option>
	<option value='https://www.r-bloggers.com/2007/06/'> June 2007 &nbsp;(3)</option>
	<option value='https://www.r-bloggers.com/2007/05/'> May 2007 &nbsp;(3)</option>
	<option value='https://www.r-bloggers.com/2007/04/'> April 2007 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2007/03/'> March 2007 &nbsp;(5)</option>
	<option value='https://www.r-bloggers.com/2007/02/'> February 2007 &nbsp;(4)</option>
	<option value='https://www.r-bloggers.com/2006/11/'> November 2006 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2006/10/'> October 2006 &nbsp;(2)</option>
	<option value='https://www.r-bloggers.com/2006/08/'> August 2006 &nbsp;(3)</option>
	<option value='https://www.r-bloggers.com/2006/07/'> July 2006 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2006/06/'> June 2006 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2006/05/'> May 2006 &nbsp;(3)</option>
	<option value='https://www.r-bloggers.com/2006/04/'> April 2006 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2006/03/'> March 2006 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2006/02/'> February 2006 &nbsp;(5)</option>
	<option value='https://www.r-bloggers.com/2006/01/'> January 2006 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2005/10/'> October 2005 &nbsp;(1)</option>
	<option value='https://www.r-bloggers.com/2005/09/'> September 2005 &nbsp;(3)</option>
	<option value='https://www.r-bloggers.com/2005/05/'> May 2005 &nbsp;(1)</option>

		</select>

<script type="376714593608de8c39e32b38-text/javascript">
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "archives-dropdown-3" );
	function onSelectChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value !== '' ) {
			document.location.href = this.options[ this.selectedIndex ].value;
		}
	}
	dropdown.onchange = onSelectChange;
})();
/* ]]> */
</script>
			</div><div id="linkcat-3349" class="sb-widget widget_links"><h4 class="widget-title">Other sites</h4>
	<ul class='xoxo blogroll'>
<li><a href="https://www.r-users.com/">Jobs for R-users</a></li>
<li><a href="http://www.proc-x.com/" title="SAS news gathered from bloggers">SAS blogs</a></li>

	</ul>
</div>
</aside></div>
</div>
<div class="copyright-wrap">
	<p class="copyright">Copyright &copy; 2021 | <a href="https://www.mhthemes.com/" rel="nofollow">MH Corporate basic by MH Themes</a></p>
</div>
</div>

<!--
TPC! Memory Usage (http://webjawns.com)
Memory Usage: 20046504Memory Peak Usage: 20148280WP Memory Limit: 820MPHP Memory Limit: 128MCheckpoints: 9-->


<!-- Schema & Structured Data For WP v1.9.85 - -->
<script type="application/ld+json" class="saswp-schema-markup-output">
[{"@context":"https:\/\/schema.org","@graph":[{"@type":"Organization","@id":"https:\/\/www.r-bloggers.com#Organization","name":"R-bloggers","url":"https:\/\/www.r-bloggers.com","sameAs":[],"logo":{"@type":"ImageObject","url":"http:\/\/www.r-bloggers.com\/wp-content\/uploads\/2021\/05\/R_blogger_logo1_large.png","width":"1285","height":"369"},"contactPoint":{"@type":"ContactPoint","contactType":"technical support","telephone":"","url":"https:\/\/www.r-bloggers.com\/contact-us\/"}},{"@type":"WebSite","@id":"https:\/\/www.r-bloggers.com#website","headline":"R-bloggers","name":"R-bloggers","description":"R news and tutorials contributed by hundreds of R bloggers","url":"https:\/\/www.r-bloggers.com","potentialAction":{"@type":"SearchAction","target":"https:\/\/www.r-bloggers.com\/?s={search_term_string}","query-input":"required name=search_term_string"},"publisher":{"@id":"https:\/\/www.r-bloggers.com#Organization"}},{"@context":"https:\/\/schema.org","@type":"WebPage","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#webpage","name":"Spatial Data Analysis with INLA","url":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/","lastReviewed":"2019-11-04T18:00:00-06:00","inLanguage":"en-US","description":"by Virgilio G\u00f3mez Rubio A Bayesian hierarchical model can be defined as follows: The posterior distribution of the hyperparameters \\(\\pi(\\mathbf{\\theta}\\mid \\mathbf{y})\\) is approximated using different methods. The dataset can be loaded as follows:  Interactive maps can be easily created with the tmap package: In order to fit the model with INLA, function inla is used: Next, the summary of the model can be obtained: Now the summary of the mode includes information about the random effects:  Note how the model smooths the relative risk. This will return an nb object with the definition of the neighborhood structure:  The vector of random effects \\(u\\) is modeled as a multivariate Normal distribution: Intrinsic CAR (ICAR): \\(n_i\\) is the number of neighbors of area \\(i\\). \\(\\Sigma_{i,j}\\) depends on a function of \\(d(i,j)\\). For example: \u2018Mixture\u2019 of matrices (Leroux et al.\u2019s model): \\(M\\) precision of intrinsic CAR specification Here, \\(M\\) precision of intrinsic CAR specification. Here, \\(C\\) is a matrix and \\(\\lambda_{max}\\) its maximum eigenvalue. In order to define the right model, we should take matrix \\(C\\) as follows: Then, \\(\\lambda_{max} = 1\\) and To fit the model, the first step is to create matrix \\(M\\): We can check that the maximum eigenvalue, \\(\\lambda_{max}\\), is one: This model includes covariates and an autoregressive on the error term: This model includes covariates and an autoregressive on the response: The elements of this model are: In order to define a model, we need: Estimates of the coefficients appear as part of the random effects:   Note how spatial models produce smoother estimates of the relative risk.","reviewedBy":{"@type":"Organization","name":"R-bloggers","url":"https:\/\/www.r-bloggers.com","logo":{"@type":"ImageObject","url":"http:\/\/www.r-bloggers.com\/wp-content\/uploads\/2021\/05\/R_blogger_logo1_large.png","width":"1285","height":"369"}},"primaryImageOfPage":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#primaryimage"},"mainContentOfPage":[[{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Home","url":"https:\/\/www.r-bloggers.com"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"About","url":"http:\/\/www.r-bloggers.com\/about\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"RSS","url":"https:\/\/feeds.feedburner.com\/RBloggers"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"add your blog!","url":"http:\/\/www.r-bloggers.com\/add-your-blog\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Learn R","url":"https:\/\/www.r-bloggers.com\/how-to-learn-r-2\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"R jobs","url":"https:\/\/www.r-users.com\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Submit a new job (it's free)","url":"https:\/\/www.r-users.com\/submit-job\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Browse latest jobs (also free)","url":"https:\/\/www.r-users.com\/"},{"@context":"https:\/\/schema.org","@type":"SiteNavigationElement","@id":"https:\/\/www.r-bloggers.com\/#top nav","name":"Contact us","url":"http:\/\/www.r-bloggers.com\/contact-us\/"}]],"isPartOf":{"@id":"https:\/\/www.r-bloggers.com#website"},"breadcrumb":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#breadcrumb"}},{"@type":"BreadcrumbList","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https:\/\/www.r-bloggers.com","name":"R-bloggers"}},{"@type":"ListItem","position":2,"item":{"@id":"https:\/\/www.r-bloggers.com\/category\/r-bloggers\/","name":"R bloggers"}},{"@type":"ListItem","position":3,"item":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/","name":"Spatial Data Analysis with INLA"}}]},{"@type":"Article","@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#Article","url":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/","inLanguage":"en-US","mainEntityOfPage":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#webpage","headline":"Spatial Data Analysis with INLA","description":"by Virgilio G\u00f3mez Rubio A Bayesian hierarchical model can be defined as follows: The posterior distribution of the hyperparameters \\(\\pi(\\mathbf{\\theta}\\mid \\mathbf{y})\\) is approximated using different methods. The dataset can be loaded as follows:  Interactive maps can be easily created with the tmap package: In order to fit the model with INLA, function inla is used: Next, the summary of the model can be obtained: Now the summary of the mode includes information about the random effects:  Note how the model smooths the relative risk. This will return an nb object with the definition of the neighborhood structure:  The vector of random effects \\(u\\) is modeled as a multivariate Normal distribution: Intrinsic CAR (ICAR): \\(n_i\\) is the number of neighbors of area \\(i\\). \\(\\Sigma_{i,j}\\) depends on a function of \\(d(i,j)\\). For example: \u2018Mixture\u2019 of matrices (Leroux et al.\u2019s model): \\(M\\) precision of intrinsic CAR specification Here, \\(M\\) precision of intrinsic CAR specification. Here, \\(C\\) is a matrix and \\(\\lambda_{max}\\) its maximum eigenvalue. In order to define the right model, we should take matrix \\(C\\) as follows: Then, \\(\\lambda_{max} = 1\\) and To fit the model, the first step is to create matrix \\(M\\): We can check that the maximum eigenvalue, \\(\\lambda_{max}\\), is one: This model includes covariates and an autoregressive on the error term: This model includes covariates and an autoregressive on the response: The elements of this model are: In order to define a model, we need: Estimates of the coefficients appear as part of the random effects:   Note how spatial models produce smoother estimates of the relative risk.","articleBody":"by Virgilio G\u00f3mez Rubio                Introduction In this session I will focus on Bayesian inference using the integrated nested Laplace approximation (INLA) method. As described in Rue et al. (2009), INLA can be used to estimate the posterior marginal distribution of Bayesian hierarchical models. This method is implemented in the INLA package available for the R programming language. Given that the types of models that INLA can fit are quite wide, we will focus on spatial models for the analysis of lattice data. Hence,   Bayesian inference A Bayesian hierarchical model can be defined as follows: \\[ y_i \\sim f(y_i \\mid \\mathbf{x}, \\theta_1) \\] \\[ \\mathbf{x} \\sim GMRF(\\theta_2) \\] \\[ \\theta \\sim \\pi(\\theta) \\] Here, \\(\\mathbf{y}  (y_1, \\ldots, y_n)\\) is a vector of responses, \\(\\mathbf{x}\\) a vector of latent effects and \\(\\theta  (\\theta_1, \\theta_2)\\) a vector of hyperparameters. \\(GMRF(\\theta_2)\\) is a Gaussian Markov random field (GMRF) with zero mean, which can be regarded as a multivariate Gaussian distribution with zero mean and sparse precision matrix that depends on hyperparameters \\(\\theta_2\\). Fitting a Bayesian model means computing the posterior distribution of \\(\\mathbf{x}\\) and \\(\\theta\\) \\(\\pi(\\theta, \\mathbf{x} \\mid y)\\). This can be obtained by using Bayes\u2019 rule as follows: \\[ \\pi(\\theta, \\mathbf{x} \\mid y)  \\propto \\pi(y \\mid \\theta, \\mathbf{x})\\pi(\\theta) \\] Once the joint posterior distribution is known, we could compute posterior probabilities of linear predictors, random effects, sums of random effects, etc. Depending on the likelihood and the prior distribution computing \\(\\pi(\\theta, \\mathbf{x} \\mid y)\\) can be very difficult.  Inference with Markov chain Monte Carlo In the last 20-30 years some computational approaches have been proposed to estimate \\(\\pi(\\theta, \\mathbf{x} \\mid y)\\) with Monte Carlo methods. In particular, Markov chain Monte Carlo (MCMC) methods provide simulations from the ensemble of model parameters, i.e., a multivariate distribution. This will allow us to estimate the joint posterior distribution. However, we may be interested in a single parameter or a subset of the parameters. Inference for this subset of parameters can be done by simply ignoring the samples for the other parameters Using the samples it is possible to compute the posterior distribution of any function on the model parameters. Notice that MCMC may require lots of simulations for valid inference. Also, we must check that the burn-in period has ended, i.e., we have reached the posterior distribution    Integrated Nested Laplace Approximation Sometimes we only need marginal inference on some parameters, i.e., we need \\(\\pi(\\theta_i \\mid y)\\). Rue et al. (2009) propose a way of approximating the marginal distributions using different approximations to the distributions involved and using the Laplace approximation for the integrals. Now we are dealing with (many) univariate distributions. This is computationally faster because numerical integration techniques are used instead of Monte Carlo sampling. The marginal distributions for the latent effects and hyper-parameters can be written as \\[ \\pi(x_i \\mid \\mathbf{y})  \\int \\pi(x_i \\mid \\mathbf{\\theta}, \\mathbf{y})  \\pi(\\mathbf{\\theta}\\mid \\mathbf{y}) d\\mathbf{\\theta} \\]  and \\[ \\pi(\\theta_j\\mid \\mathbf{y})  \\int \\pi(\\mathbf{\\theta}\\mid  \\mathbf{y})  d\\mathbf{\\theta}_{-j}  \\] The posterior distribution of the hyperparameters \\(\\pi(\\mathbf{\\theta}\\mid \\mathbf{y})\\) is approximated using different methods.  R-INLA package The INLA method is implemented in the INLA (also known as R-INLA) package, which is available from http:\/\/www.r-inla.org. This package relies on the inla()-function to fit the models. This functions works in a similar way as, for example, glm(). The model is defined in a  and there is a flexible way of defining the likelihood, priors and latent effects in the model. The output provides the posterior marginals of the model parameters and latent effects, linear predictors, and some other derived quantities (such as linear combinations of the model latent effects). In addition, INLA provides tools to manipulate \\(\\pi(\\cdot \\mid y)\\) to compute \\(\\pi(f(\\cdot) \\mid y)\\). INLA can compute some model assessment\/choice: Marginal likelihood, DIC, CPO, \u2026   Spatial latent effects The following table summarizes some of the spatial latent effects available in INLA:    Name in f() Model     generic0 \\(\\Sigma\\frac{1}{\\tau}Q^{-1}\\)   generic1 \\(\\Sigma\\frac{1}{\\tau}(I_n-\\frac{\\rho}{\\lambda_{max}}C)^{-1}\\)   besag Intrinsic CAR   besagproper Proper CAR   bym Convolution model   rw2d Random walk 2-D   matern2d Mat\u00e8rn correlation (discrete)   slm Spatial lag model   spde Mat\u00e8rn correlation (continuous)       Dataset: Leukemia in upstate New York To illustrate how spatial models are fitted with INLA, the New York leukemia dataset will be used. This has been widely analyzed in the literature (see, for example, Waller and Gotway, 2004) and it is available in the DClusterm package. The dataset records a number of cases of leukemia in upstate New York at the census tract level. Some of the variables in the dataset are:  Cases: Number of leukemia cases in the period 1978-1982. POP8: Population in 1980. PCTOWNHOME: Proportion of people who own their home. PCTAGE65P: Proportion of people aged 65 or more. AVGIDIST: Average inverse distance to the nearest Trichloroethene (TCE) site.  Note that the interest is on the exposure to TCE, using AVGIDIST as a proxy for exposure. Variables PCTOWNHOME and PCTAGE65P will act as possible confounders that must be included in the model. However, we will not do it here because we want to test how the spatial latent effects capture residual spatial variation. The dataset can be loaded as follows: library(spdep) library(DClusterm) data(NY8) Given that the interest is in studying the risk of leukemia in upstate New York, the expected number of cases is computed first. This is done by computing the overall mortality rate (total cases divided by total population) and multiplying the population by it: rate &lt;- sum(NY8$Cases) \/ sum(NY8$POP8) NY8$Expected &lt;- NY8$POP8 * rate Once the expected number of cases is obtained, a raw estimate of risk can be obtained with the standardized mortality ratio (SMR), which is computed as the number of observed cases divided by the number of expected cases: NY8$SMR &lt;- NY8$Cases \/ NY8$Expected  Disease mapping In Epidemiology it is important to produce maps to show the spatial distribution of the relative risk. In this example, we will focus on Syracuse city to reduce the computation time to produce the map. Hence, we create an index with the areas in Syracuse city: # Subset Syracuse city syracuse &lt;- which(NY8$AREANAME  &quot;Syracuse city&quot;) A disease map can be simply created with function spplot (in package sp): library(viridis) ## Loading required package: viridisLite spplot(NY8, &quot;SMR&quot;, #at  c(0.6, 0.9801, 1.055, 1.087, 1.125, 13),    col.regions  rev(magma(16))) #gray.colors(16, 0.9, 0.4))  Interactive maps can be easily created with the tmap package: library(tmap) tmap_mode(&quot;view&quot;)  SMR_map &lt;- tm_shape(NY8) +   tm_fill(col  &quot;SMR&quot;, alpha  0.35) +   tm_borders() +   tm_shape(TCE) + tm_dots(col  &quot;red&quot;) # Add TCE sites widgetframe::frameWidget(print(SMR_map))   Note that the previous map also includes the locations of the 11 TCE-contaminated sites and that this can be seen by zooming out.    Mixed-effects models  Poisson regression The first model that we will consider is a Poisson model with no latent random effects as this will provide a baseline to compare to other models. The model to fit is: \\[ O_i|\\mu_i \\sim Po(\\mu_i) \\] \\[ \\mu_i  E_i \\theta_i  \\] \\[ \\log(\\theta_i)  \\beta_0 + \\beta_1 AVGIDIST_i \\] In order to fit the model with INLA, function inla is used: library(INLA) m1 &lt;- inla(Cases ~ 1 + AVGIDIST,    data  as.data.frame(NY8),   family  &quot;poisson&quot;,   E  NY8$Expected, control.predictor  list(compute  TRUE),   control.compute  list(dic  TRUE, waic  TRUE)) Note that it works similarly to the glm function. Here, argument E is used for the expected number of cases. Alternatively, they could enter the linear predictor in the log-scale as an offset. Other arguments are set to compute the marginals of the model parameters (with control.predictor) and to compute some model choice criteria (with control.compute). Next, the summary of the model can be obtained: summary(m1) ##  ## Call: ##    c(&quot;inla(formula  Cases ~ 1 + AVGIDIST, family  \\&quot;poisson\\&quot;, data  ##     as.data.frame(NY8), &quot;, &quot; E  NY8$Expected, control.compute   ##    list(dic  TRUE, waic  TRUE), &quot;, &quot; control.predictor   ##    list(compute  TRUE))&quot;)  ## Time used: ##     Pre  0.368, Running  0.0968, Post  0.0587, Total  0.524  ## Fixed effects: ##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld ## (Intercept) -0.065 0.045     -0.155   -0.065      0.023 -0.064   0 ## AVGIDIST     0.320 0.078      0.160    0.322      0.465  0.327   0 ##  ## Expected number of effective parameters(stdev): 2.00(0.00) ## Number of equivalent replicates : 140.25  ##  ## Deviance Information Criterion (DIC) ...............: 948.12 ## Deviance Information Criterion (DIC, saturated) ....: 418.75 ## Effective number of parameters .....................: 2.00 ##  ## Watanabe-Akaike information criterion (WAIC) ...: 949.03 ## Effective number of parameters .................: 2.67 ##  ## Marginal log-Likelihood:  -480.28  ## Posterior marginals for the linear predictor and ##  the fitted values are computed   Poisson regression with random effects Latent random effects can be added to the model to account for overdispersion by including i.i.d. Gaussian random effects in the linear predictor, as follows: \\[ O_i|\\mu_i \\sim Po(\\mu_i) \\] \\[ \\mu_i  E_i \\theta_i  \\] \\[ \\log(\\theta_i)  \\beta_0 + \\beta_1 AVGIDIST_i + u_i \\] \\[ u_i \\sim N(0, \\tau) \\] In order to fit the model with INLA an index to identify the random effects (ID) is created first. Latent random effects are specified with the f-function in INLA: NY8$ID &lt;- 1:nrow(NY8) m2 &lt;- inla(Cases ~ 1 + AVGIDIST + f(ID, model  &quot;iid&quot;),   data  as.data.frame(NY8), family  &quot;poisson&quot;,    E  NY8$Expected,   control.predictor  list(compute  TRUE),   control.compute  list(dic  TRUE, waic  TRUE)) Now the summary of the mode includes information about the random effects: summary(m2) ##  ## Call: ##    c(&quot;inla(formula  Cases ~ 1 + AVGIDIST + f(ID, model  \\&quot;iid\\&quot;),  ##    family  \\&quot;poisson\\&quot;, &quot;, &quot; data  as.data.frame(NY8), E   ##    NY8$Expected, control.compute  list(dic  TRUE, &quot;, &quot; waic   ##    TRUE), control.predictor  list(compute  TRUE))&quot; )  ## Time used: ##     Pre  0.236, Running  0.315, Post  0.0744, Total  0.625  ## Fixed effects: ##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld ## (Intercept) -0.126 0.064     -0.256   -0.125     -0.006 -0.122   0 ## AVGIDIST     0.347 0.105      0.139    0.346      0.558  0.344   0 ##  ## Random effects: ##   Name     Model ##     ID IID model ##  ## Model hyperparameters: ##                     mean       sd 0.025quant 0.5quant 0.975quant mode ## Precision for ID 3712.34 11263.70       3.52     6.94   39903.61 5.18 ##  ## Expected number of effective parameters(stdev): 54.95(30.20) ## Number of equivalent replicates : 5.11  ##  ## Deviance Information Criterion (DIC) ...............: 926.93 ## Deviance Information Criterion (DIC, saturated) ....: 397.56 ## Effective number of parameters .....................: 61.52 ##  ## Watanabe-Akaike information criterion (WAIC) ...: 932.63 ## Effective number of parameters .................: 57.92 ##  ## Marginal log-Likelihood:  -478.93  ## Posterior marginals for the linear predictor and ##  the fitted values are computed   Add point estimates for mapping The posterior means estimated with these two models can be added to the SpatialPolygonsDataFrame NY8 to be plotted later: NY8$FIXED.EFF &lt;- m1$summary.fitted NY8$IID.EFF &lt;- m2$summary.fitted spplot(NY8, c(&quot;SMR&quot;, &quot;FIXED.EFF&quot;, &quot;IID.EFF&quot;),   col.regions  rev(magma(16)))  Note how the model smooths the relative risk.    Spatial Models for Lattice Data Lattice data involves data measured at different areas, e.g., neighborhoods, cities, provinces, states, etc. Spatial dependence appears because neighbor areas will show similar values of the variable of interest.  Models for lattice data We have observations \\(y\\{y_i\\}_{i1}^n\\) from the \\(n\\) areas. \\(\\mathbf{y}\\) is assigned a multivariate distribution that accounts for spatial dependence. A common way of describing spatial proximity in lattice data is by means of an adjacency matrix \\(W\\). Element \\(W_{i, j}\\) is non-zero if areas \\(i\\) and \\(j\\) are neighbors. Usually, two areas are neighbors if they share a common boundary. There are other definitions of neighborhood (see Bivand et al., 2013).   Adjacency matrix The adjacency matrix can be computed using function poly2nb in package spdep. This function will consider two areas as neighbors if their borders touch at least in one point (i.e., queen adjacency): NY8.nb &lt;- poly2nb(NY8) This will return an nb object with the definition of the neighborhood structure: NY8.nb ## Neighbour list object: ## Number of regions: 281  ## Number of nonzero links: 1624  ## Percentage nonzero weights: 2.056712  ## Average number of links: 5.779359 In addition, nb objects can be plot when the centroids of the polygons are known: plot(NY8)  plot(NY8.nb, coordinates(NY8), add  TRUE, pch  &quot;.&quot;, col  &quot;gray&quot;)     Regression models It is often the case that, in addition to \\(y_i\\), we have a number of covariates \\(X_i\\). Hence, we may want to regress \\(y_i\\) on \\(X_i\\). In addition to the covariates we may want to account for the spatial structure of the data. Different types of regression models can be used to model lattice data:  Generalized Linear Models (with spatial random effects). Spatial econometrics models.   Linear Mixed Models A common approach (for Gaussian data) is to use a linear regression with random effects: \\[ Y   X \\beta+ Zu +\\varepsilon  \\] The vector of random effects \\(u\\) is modeled as a multivariate Normal distribution: \\[ u \\sim N(0, \\sigma^2_u \\Sigma) \\] \\(\\Sigma\\) is defined such as it induces higher correlation with adjacent areas, \\(Z\\) is a design matrix for the random effects and \\(\\varepsilon_i \\sim N(0, \\sigma^2), i1, \\ldots, n\\) is an error term. Generalized Linear Mixed Models can be defined in a similar way by using a different likelihood and linking the appropriate parameter to the linear predictor.   Structure of spatial random effects There are many different ways of including spatial dependence in \\(\\Sigma\\):  Simultaneous autoregressive (SAR):  \\[ \\Sigma^{-1}   \\]  Conditional autoregressive (CAR):  \\[ \\Sigma^{-1}  (I-\\rho W) \\]  Intrinsic CAR (ICAR): \\[ \\Sigma^{-1}  diag(n_i) - W \\] \\(n_i\\) is the number of neighbors of area \\(i\\). \\(\\Sigma_{i,j}\\) depends on a function of \\(d(i,j)\\). For example:  \\[ \\Sigma_{i,j}  \\exp\\{-d(i,j)\/\\phi\\} \\]  \u2018Mixture\u2019 of matrices (Leroux et al.\u2019s model): \\[ \\Sigma  ^{-1};\\ \\lambda \\in (0,1) \\] \\(M\\) precision of intrinsic CAR specification  CAR and ICAR specifications have been proposed within the Statistics field, while the SAR specification was coined within Spatial Econometrics. Regardless of its origin, all specifications presented here can be regarded as Gaussian latent effects with a particular precision matrix.   ICAR model The first example will be based on the ICAR specification. Note that the spatial latent effect is defined using the f-function. This will require an index to identify the random effects in each area, the type of model and the adjacency matrix. For this, a sparse matrix will be used. # Create sparse adjacency matrix NY8.mat &lt;- as(nb2mat(NY8.nb, style  &quot;B&quot;), &quot;Matrix&quot;) # Fit model m.icar &lt;- inla(Cases ~ 1 +  AVGIDIST +      f(ID, model  &quot;besag&quot;, graph  NY8.mat),   data  as.data.frame(NY8), E  NY8$Expected, family &quot;poisson&quot;,   control.predictor  list(compute  TRUE),   control.compute  list(dic  TRUE, waic  TRUE)) summary(m.icar) ##  ## Call: ##    c(&quot;inla(formula  Cases ~ 1 + AVGIDIST + f(ID, model  \\&quot;besag\\&quot;,  ##    &quot;, &quot; graph  NY8.mat), family  \\&quot;poisson\\&quot;, data   ##    as.data.frame(NY8), &quot;, &quot; E  NY8$Expected, control.compute   ##    list(dic  TRUE, waic  TRUE), &quot;, &quot; control.predictor   ##    list(compute  TRUE))&quot;)  ## Time used: ##     Pre  0.298, Running  0.305, Post  0.0406, Total  0.644  ## Fixed effects: ##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld ## (Intercept) -0.122 0.052     -0.226   -0.122     -0.022 -0.120   0 ## AVGIDIST     0.318 0.121      0.075    0.320      0.551  0.324   0 ##  ## Random effects: ##   Name     Model ##     ID Besags ICAR model ##  ## Model hyperparameters: ##                  mean   sd 0.025quant 0.5quant 0.975quant mode ## Precision for ID 3.20 1.67       1.41     2.79       7.56 2.27 ##  ## Expected number of effective parameters(stdev): 46.68(12.67) ## Number of equivalent replicates : 6.02  ##  ## Deviance Information Criterion (DIC) ...............: 904.12 ## Deviance Information Criterion (DIC, saturated) ....: 374.75 ## Effective number of parameters .....................: 48.31 ##  ## Watanabe-Akaike information criterion (WAIC) ...: 906.77 ## Effective number of parameters .................: 44.27 ##  ## Marginal log-Likelihood:  -685.70  ## Posterior marginals for the linear predictor and ##  the fitted values are computed   BYM model The Besag, York and Molli\u00e9 model includes two latent random effects: an ICAR latent effect and a Gaussian iid latent effect. The linear predictor \\(\\eta_i\\) is: \\[ \\eta_i  \\alpha + \\beta AVGIDIST_i + u_i + v_i \\]  \\(u_i\\) is an i.i.d. Gaussian random effect \\(v_i\\) is an intrinsic CAR random effect  There is no need to define these two latent effects if model is set to &quot;bym&quot; when the latent random effect is defined with the f function. m.bym  inla(Cases ~ 1 +  AVGIDIST +      f(ID, model  &quot;bym&quot;, graph  NY8.mat),   data  as.data.frame(NY8), E  NY8$Expected, family &quot;poisson&quot;,   control.predictor  list(compute  TRUE),   control.compute  list(dic  TRUE, waic  TRUE)) summary(m.bym) ##  ## Call: ##    c(&quot;inla(formula  Cases ~ 1 + AVGIDIST + f(ID, model  \\&quot;bym\\&quot;,  ##    graph  NY8.mat), &quot;, &quot; family  \\&quot;poisson\\&quot;, data   ##    as.data.frame(NY8), E  NY8$Expected, &quot;, &quot; control.compute   ##    list(dic  TRUE, waic  TRUE), control.predictor  list(compute   ##    TRUE))&quot; )  ## Time used: ##     Pre  0.294, Running  1, Post  0.0652, Total  1.36  ## Fixed effects: ##               mean    sd 0.025quant 0.5quant 0.975quant   mode kld ## (Intercept) -0.123 0.052     -0.227   -0.122     -0.023 -0.121   0 ## AVGIDIST     0.318 0.121      0.075    0.320      0.551  0.324   0 ##  ## Random effects: ##   Name     Model ##     ID BYM model ##  ## Model hyperparameters: ##                                         mean      sd 0.025quant 0.5quant ## Precision for ID (iid component)     1790.06 1769.02     115.76  1265.24 ## Precision for ID (spatial component)    3.12    1.36       1.37     2.82 ##                                      0.975quant   mode ## Precision for ID (iid component)        6522.28 310.73 ## Precision for ID (spatial component)       6.58   2.33 ##  ## Expected number of effective parameters(stdev): 47.66(12.79) ## Number of equivalent replicates : 5.90  ##  ## Deviance Information Criterion (DIC) ...............: 903.41 ## Deviance Information Criterion (DIC, saturated) ....: 374.04 ## Effective number of parameters .....................: 48.75 ##  ## Watanabe-Akaike information criterion (WAIC) ...: 906.61 ## Effective number of parameters .................: 45.04 ##  ## Marginal log-Likelihood:  -425.65  ## Posterior marginals for the linear predictor and ##  the fitted values are computed   Leroux et al.\u00a0model This model is defined using a \u2018mixture\u2019 of matrices (Leroux et al.\u2019s model) to define the precision matrix of the latent effect: \\[ \\Sigma^{-1}  ;\\ \\lambda \\in (0,1) \\] Here, \\(M\\) precision of intrinsic CAR specification. This model is implemented using the generic1 latent effect, which uses the following precision matrix: \\[ \\Sigma^{-1}  \\frac{1}{\\tau}(I_n-\\frac{\\rho}{\\lambda_{max}}C); \\rho \\in [0,1) \\] Here, \\(C\\) is a matrix and \\(\\lambda_{max}\\) its maximum eigenvalue. In order to define the right model, we should take matrix \\(C\\) as follows: \\[ C  I_n - M;\\ M  diag(n_i) - W \\] Then, \\(\\lambda_{max}  1\\) and \\[ \\Sigma^{-1}   \\frac{1}{\\tau}(I_n-\\frac{\\rho}{\\lambda_{max}}C)     \\frac{1}{\\tau}(I_n-\\rho(I_n - M))  \\frac{1}{\\tau}((1-\\rho) I_n + \\rho M) \\] To fit the model, the first step is to create matrix \\(M\\): ICARmatrix &lt;- Diagonal(nrow(NY8.mat), apply(NY8.mat, 1, sum)) - NY8.mat Cmatrix &lt;- Diagonal(nrow(NY8), 1) -  ICARmatrix We can check that the maximum eigenvalue, \\(\\lambda_{max}\\), is one: max(eigen(Cmatrix)$values) ##  1 The model is fit as usual with function inla. Note that the \\(C\\) matrix is passed to the f function using argument Cmatrix: m.ler  inla(Cases ~ 1 +  AVGIDIST +     f(ID, model  &quot;generic1&quot;, Cmatrix  Cmatrix),   data  as.data.frame(NY8), E  NY8$Expected, family &quot;poisson&quot;,   control.predictor  list(compute  TRUE),   control.compute  list(dic  TRUE, waic  TRUE)) summary(m.ler) ##  ## Call: ##    c(&quot;inla(formula  Cases ~ 1 + AVGIDIST + f(ID, model   ##    \\&quot;generic1\\&quot;, &quot;, &quot; Cmatrix  Cmatrix), family  \\&quot;poisson\\&quot;, data  ##     as.data.frame(NY8), &quot;, &quot; E  NY8$Expected, control.compute   ##    list(dic  TRUE, waic  TRUE), &quot;, &quot; control.predictor   ##    list(compute  TRUE))&quot;)  ## Time used: ##     Pre  0.236, Running  0.695, Post  0.0493, Total  0.98  ## Fixed effects: ##               mean    sd 0.025quant 0.5quant 0.975quant   mode   kld ## (Intercept) -0.128 0.448      -0.91   -0.128      0.656 -0.126 0.075 ## AVGIDIST     0.325 0.122       0.08    0.327      0.561  0.330 0.000 ##  ## Random effects: ##   Name     Model ##     ID Generic1 model ##  ## Model hyperparameters: ##                   mean    sd 0.025quant 0.5quant 0.975quant  mode ## Precision for ID 2.720 1.098       1.27    2.489      5.480 2.106 ## Beta for ID      0.865 0.142       0.47    0.915      0.997 0.996 ##  ## Expected number of effective parameters(stdev): 52.25(13.87) ## Number of equivalent replicates : 5.38  ##  ## Deviance Information Criterion (DIC) ...............: 903.14 ## Deviance Information Criterion (DIC, saturated) ....: 373.77 ## Effective number of parameters .....................: 53.12 ##  ## Watanabe-Akaike information criterion (WAIC) ...: 906.20 ## Effective number of parameters .................: 48.19 ##  ## Marginal log-Likelihood:  -474.94  ## Posterior marginals for the linear predictor and ##  the fitted values are computed    Spatial Econometrics Models Spatial econometrics have been developed following a slightly different approach to spatial modeling. Instead of using latent effects, spatial dependence is modeled explicitly. Autoregressive models are used to make the response variable to depend on the values of its neighbors.  Simultaneous Autoregressive Model (SEM) This model includes covariates and an autoregressive on the error term: \\[ y X \\beta+u; u\\rho Wu+e; e\\sim N(0, \\sigma^2) \\] \\[ y X \\beta + \\varepsilon; \\varepsilon\\sim N(0, \\sigma^2 (I-\\rho W)^{-1} (I-\\rho W&#39;)^{-1}) \\]   Spatial Lag Model (SLM) This model includes covariates and an autoregressive on the response: \\[ y  \\rho W y + X \\beta + e; e\\sim N(0, \\sigma^2) \\] \\[ y  (I-\\rho W)^{-1}X\\beta+\\varepsilon;\\ \\varepsilon \\sim N(0, \\sigma^2(I-\\rho W)^{-1} (I-\\rho W&#39;)^{-1}) \\]   New slm Latent Class R-INLA includes now an experimental new latent effect called slm to fit the following model: \\[ \\mathbf{x} (I_n-\\rho W)^{-1} (X\\beta +e) \\] The elements of this model are:  \\(W\\) is a row-standardized adjacency matrix. \\(\\rho\\) is a spatial autocorrelation parameter. \\(X\\) is a matrix of covariates, with coefficients \\(\\beta\\). \\(e\\) are Gaussian i.i.d. errors with variance \\(\\sigma^2\\).  The slm latent effect is experimental and it can be combined with other effects in the linear predictor Spatial econometrics models can be fit with the slm latent effect by noting that the SME and SLM can be defined as:  SEM  \\[ y X \\beta + (I-\\rho W)^{-1} (0+e);\\ e \\sim N(0, \\sigma^2 I) \\]  SLM  \\[ y  (I-\\rho W)^{-1}(X\\beta+e);\\ e \\sim N(0, \\sigma^2 I) \\]   Model definition In order to define a model, we need:  X: Matrix of covariates W: Row-standardized adjacency matrix Q: Precision matrix of coefficients \\(\\beta\\) Range of \\(\\rho\\), often defined by the eigenvalues  #X mmatrix &lt;- model.matrix(Cases ~ 1 + AVGIDIST, NY8)  #W W &lt;- as(nb2mat(NY8.nb, style  &quot;W&quot;), &quot;Matrix&quot;)  #Q Q.beta  Diagonal(n  ncol(mmatrix), x  0.001)  #Range of rho rho.min&lt;- -1 rho.max&lt;- 1 The argument of the slm latent effects are passed through argument args.sm. Here, we have created a list with the same name to keep all the required values together: #Arguments for &#39;slm&#39; args.slm  list(    rho.min  rho.min ,    rho.max  rho.max,    W  W,    X  mmatrix,    Q.beta  Q.beta ) In addition, the prior for the precision parameter\\(\\tau\\) and the spatial autocorrelation parameter \\(\\rho\\) are set: #Prior on rho hyper.slm  list(    prec  list(       prior  &quot;loggamma&quot;, param  c(0.01, 0.01)),       rho  list(initial0, prior  &quot;logitbeta&quot;, param  c(1,1)) ) The prior definition uses a named list with different arguments. Argument prior defines the prior to use, and param its parameters. Here, the precision is assigned a gamma prior with parameters \\(0.01\\) and \\(0.01\\), while the spatial autocorrelation parameter is given a beta prior with parameters \\(1\\) and \\(1\\) (i.e., a uniform prior in the interval \\((1, 1)\\)).   Model fitting #SLM model m.slm &lt;- inla( Cases ~ -1 +      f(ID, model  &quot;slm&quot;, args.slm  args.slm, hyper  hyper.slm),    data  as.data.frame(NY8), family  &quot;poisson&quot;,    E  NY8$Expected,    control.predictor  list(compute  TRUE),    control.compute  list(dic  TRUE, waic  TRUE) ) ## Warning in inla.model.properties.generic(inla.trim.family(model), (mm[names(mm)  : Model &#39;slm&#39; in section &#39;latent&#39; is marked as &#39;experimental&#39;; changes may appear at any time. ##   Use this model with extra care!!! Further warnings are disabled. summary(m.slm) ##  ## Call: ##    c(&quot;inla(formula  Cases ~ -1 + f(ID, model  \\&quot;slm\\&quot;, args.slm   ##    args.slm, &quot;, &quot; hyper  hyper.slm), family  \\&quot;poisson\\&quot;, data   ##    as.data.frame(NY8), &quot;, &quot; E  NY8$Expected, control.compute   ##    list(dic  TRUE, waic  TRUE), &quot;, &quot; control.predictor   ##    list(compute  TRUE))&quot;)  ## Time used: ##     Pre  0.265, Running  1.2, Post  0.058, Total  1.52  ## Random effects: ##   Name     Model ##     ID SLM model ##  ## Model hyperparameters: ##                   mean    sd 0.025quant 0.5quant 0.975quant  mode ## Precision for ID 8.989 4.115      3.709    8.085     19.449 6.641 ## Rho for ID       0.822 0.073      0.653    0.832      0.936 0.854 ##  ## Expected number of effective parameters(stdev): 62.82(15.46) ## Number of equivalent replicates : 4.47  ##  ## Deviance Information Criterion (DIC) ...............: 902.32 ## Deviance Information Criterion (DIC, saturated) ....: 372.95 ## Effective number of parameters .....................: 64.13 ##  ## Watanabe-Akaike information criterion (WAIC) ...: 905.19 ## Effective number of parameters .................: 56.12 ##  ## Marginal log-Likelihood:  -477.30  ## Posterior marginals for the linear predictor and ##  the fitted values are computed Estimates of the coefficients appear as part of the random effects: round(m.slm$summary.random$ID, 4) ##    ID   mean     sd 0.025quant 0.5quant 0.975quant   mode kld ## 47 47 0.4634 0.3107    -0.1618   0.4671     1.0648 0.4726   0 ## 48 48 0.2606 0.3410    -0.4583   0.2764     0.8894 0.3063   0 Spatial autocorrelation is reported in the internal scale (i.e., between 0 and 1) and needs to be re-scaled: marg.rho.internal &lt;- m.slm$marginals.hyperpar] marg.rho &lt;- inla.tmarginal( function(x) {   rho.min + x * (rho.max - rho.min) }, marg.rho.internal)  inla.zmarginal(marg.rho, FALSE) ## Mean            0.644436  ## Stdev           0.145461  ## Quantile  0.025 0.309507  ## Quantile  0.25  0.556851  ## Quantile  0.5   0.663068  ## Quantile  0.75  0.752368  ## Quantile  0.975 0.869702 plot(marg.rho, type  &quot;l&quot;, main  &quot;Spatial autocorrelation&quot;)     Summary of results NY8$ICAR &lt;- m.icar$summary.fitted.values NY8$BYM &lt;- m.bym$summary.fitted.values NY8$LEROUX &lt;- m.ler$summary.fitted.values NY8$SLM &lt;- m.slm$summary.fitted.values spplot(NY8,    c(&quot;FIXED.EFF&quot;, &quot;IID.EFF&quot;, &quot;ICAR&quot;, &quot;BYM&quot;, &quot;LEROUX&quot;, &quot;SLM&quot;),   col.regions  rev(magma(16)) )  Note how spatial models produce smoother estimates of the relative risk. In order to choose the best model, the model selection criteria computed above can be used:     Marg. Lik. DIC WAIC     FIXED -480.2814 948.1198 949.0287   IID -478.6043 926.9295 932.6333   ICAR -685.6478 904.1253 906.7689   BYM -425.2479 903.4114 906.6138   LEROUX -474.4091 903.1453 906.1948   SLM -476.8145 902.3201 905.1892      References Bivand, R., E. Pebesma and V. G\u00f3mez-Rubio (2013). Applied spatial data analysis with R. Springer-Verlag. New York. G\u00f3mez-Rubio, V. (2020). Bayesian inference with INLA. CRC Press. Boca Raton, FL. https:\/\/becarioprecario.bitbucket.io\/inla-gitbook Rue, H., S. Martino and N. Chopin (2009). Approximate bayesian inference for latent Gaussian models by using integrated nested Laplace approximations. Journal of the royal statistical society: Series B (statistical methodology) 71(2): 319\u2013392. Waller, L. A. and C. A. Gotway (2004). Applied spatial statistics for public health data. John Wiley &amp; Sons, Inc.\u00a0Hoboken, New Jersey.","keywords":"","datePublished":"2019-11-04T18:00:00-06:00","dateModified":"2019-11-04T18:00:00-06:00","author":{"@type":"Person","name":"R on Coding Club UC3M","description":"","url":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/","sameAs":["\/categories\/r\/"],"image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","height":96,"width":96}},"editor":{"@type":"Person","name":"R on Coding Club UC3M","description":"","url":"https:\/\/www.r-bloggers.com\/author\/r-on-coding-club-uc3m\/","sameAs":["\/categories\/r\/"],"image":{"@type":"ImageObject","url":"https:\/\/secure.gravatar.com\/avatar\/?s=96&d=mm&r=g","height":96,"width":96}},"publisher":{"@id":"https:\/\/www.r-bloggers.com#Organization"},"image":[{"@type":"ImageObject","url":"https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-5-1.png","width":1344,"height":960,"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#primaryimage"},{"@type":"ImageObject","url":"https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-12-1.png","width":1536,"height":768},{"@type":"ImageObject","url":"https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-15-1.png","width":1344,"height":960},{"@type":"ImageObject","url":"https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-31-1.png","width":1344,"height":960},{"@type":"ImageObject","url":"https:\/\/codingclubuc3m.rbind.io\/post\/2019-11-05_files\/figure-html\/unnamed-chunk-33-1.png","width":1344,"height":960}],"isPartOf":{"@id":"https:\/\/www.r-bloggers.com\/2019\/11\/spatial-data-analysis-with-inla\/#webpage"}}]}]
</script>

    <script type="376714593608de8c39e32b38-text/javascript">
        var snp_f = [];
        var snp_hostname = new RegExp(location.host);
        var snp_http = new RegExp("^(http|https)://", "i");
        var snp_cookie_prefix = '';
        var snp_separate_cookies = false;
        var snp_ajax_url = 'https://www.r-bloggers.com/wp-admin/admin-ajax.php';
		var snp_ajax_nonce = '590e19d30d';
        var snp_ignore_cookies = false;
        var snp_enable_analytics_events = true;
        var snp_enable_mobile = false;
        var snp_use_in_all = false;
        var snp_excluded_urls = [];
            </script>
    <div class="snp-root">
        <input type="hidden" id="snp_popup" value="" />
        <input type="hidden" id="snp_popup_id" value="" />
        <input type="hidden" id="snp_popup_theme" value="" />
        <input type="hidden" id="snp_exithref" value="" />
        <input type="hidden" id="snp_exittarget" value="" />
        	<div id="snppopup-welcome" class="snp-pop-109583 snppopup"><input type="hidden" class="snp_open" value="scroll" /><input type="hidden" class="snp_show_on_exit" value="2" /><input type="hidden" class="snp_exit_js_alert_text" value="" /><input type="hidden" class="snp_exit_scroll_down" value="10" /><input type="hidden" class="snp_exit_scroll_up" value="10" /><input type="hidden" class="snp_open_scroll" value="45" /><input type="hidden" class="snp_close_scroll" value="10" /><input type="hidden" class="snp_optin_redirect_url" value="" /><input type="hidden" class="snp_show_cb_button" value="yes" /><input type="hidden" class="snp_popup_id" value="109583" /><input type="hidden" class="snp_popup_theme" value="theme6" /><input type="hidden" class="snp_overlay" value="disabled" /><input type="hidden" class="snp_cookie_conversion" value="30" /><input type="hidden" class="snp_cookie_close" value="180" /><div class="snp-fb snp-theme6">
    <div class="snp-subscribe-inner">
	<h1 class="snp-header"><i>Never miss an update! </i>
<br/>
<strong>Subscribe to R-bloggers</strong> to receive <br/>e-mails with the latest R posts.<br/>

<small>(You will not see this message again.)</small></h1>	<div class="snp-form">
	    <form action="https://r-bloggers.com/phplist/?p=subscribe&id=1" method="post" class="snp-subscribeform snp_subscribeform">
				<fieldset>
		    <div class="snp-field">
			<input type="text" name="email" id="snp_email" placeholder="Your E-mail..." class="snp-field snp-field-email" />		
		    </div>
		    <button type="submit" class="snp-submit">Submit</button>
		</fieldset>
	    </form>
	</div>
	<a href="#" class="snp_nothanks snp-close">Click here to close (This popup will not appear again)</a>    </div>
    </div>
<style>.snp-pop-109583 .snp-theme6 { max-width: 700px;}
.snp-pop-109583 .snp-theme6 h1 {font-size: 17px;}
.snp-pop-109583 .snp-theme6 { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field ::-webkit-input-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-moz-placeholder { color: #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field :-ms-input-placeholder { color: #a0a4a9;}
.snp-pop-109583  .snp-theme6 .snp-field input { border: 1px solid #a0a4a9;}
.snp-pop-109583 .snp-theme6 .snp-field { color: #000000;}
.snp-pop-109583 .snp-theme6 { background: #f2f2f2;}
</style><script type="376714593608de8c39e32b38-text/javascript">
jQuery(document).ready(function() {
});
</script>
</div>        <script type="376714593608de8c39e32b38-text/javascript">
            var CaptchaCallback = function() {
                jQuery('.g-recaptcha').each(function(index, el) {
                    grecaptcha.render(el, {
                        'sitekey' : ''
                    });
                });
            };
        </script>
    </div>
    <script type="376714593608de8c39e32b38-text/javascript">/* <![CDATA[ */!function(e,n){var r={"selectors":{"block":"pre","inline":"code"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"scroll","linenumbers":false,"theme":"enlighter","language":"r","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""},"resources":["https:\/\/www.r-bloggers.com\/wp-content\/plugins\/enlighter\/cache\/enlighterjs.min.css?4WJrVky+dDEQ83W","https:\/\/www.r-bloggers.com\/wp-content\/plugins\/enlighter\/resources\/enlighterjs\/enlighterjs.min.js"]},o=document.getElementsByTagName("head")[0],t=n&&(n.error||n.log)||function(){};e.EnlighterJSINIT=function(){!function(e,n){var r=0,l=null;function c(o){l=o,++r==e.length&&(!0,n(l))}e.forEach(function(e){switch(e.match(/\.([a-z]+)(?:[#?].*)?$/)[1]){case"js":var n=document.createElement("script");n.onload=function(){c(null)},n.onerror=c,n.src=e,n.async=!0,o.appendChild(n);break;case"css":var r=document.createElement("link");r.onload=function(){c(null)},r.onerror=c,r.rel="stylesheet",r.type="text/css",r.href=e,r.media="all",o.appendChild(r);break;default:t("Error: invalid file extension",e)}})}(r.resources,function(e){e?t("Error: failed to dynamically load EnlighterJS resources!",e):"undefined"!=typeof EnlighterJS?EnlighterJS.init(r.selectors.block,r.selectors.inline,r.options):t("Error: EnlighterJS resources not loaded yet!")})},(document.querySelector(r.selectors.block)||document.querySelector(r.selectors.inline))&&e.EnlighterJSINIT()}(window,console); /* ]]> */</script><script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/js/jquery.ck.min.js?ver=5.5.6' id='jquery-np-cookie-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/js/dialog_trigger.js?ver=5.5.6' id='js-dialog_trigger-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/js/ninjapopups.min.js?ver=5.5.6' id='js-ninjapopups-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/plugins/arscode-ninja-popups/fancybox2/jquery.fancybox.min.js?ver=5.5.6' id='fancybox2-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://c0.wp.com/p/jetpack/7.3.3/_inc/build/photon/photon.min.js' id='jetpack-photon-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" id='flying-pages-js-before'>
window.FPConfig= {
	delay: 0,
	ignoreKeywords: ["\/wp-admin","\/wp-login.php","\/cart","add-to-cart","logout","#","?",".png",".jpeg",".jpg",".gif",".svg"],
	maxRPS: 3,
    hoverDelay: 50
};
</script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://www.r-bloggers.com/wp-content/plugins/flying-pages/flying-pages.min.js?ver=2.4.2' id='flying-pages-js' defer></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=202139' id='devicepx-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://c0.wp.com/p/jetpack/7.3.3/_inc/build/lazy-images/js/lazy-images.min.js' id='jetpack-lazy-images-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://c0.wp.com/c/5.5.6/wp-includes/js/wp-embed.min.js' id='wp-embed-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML&#038;ver=1.3.11' id='mathjax-js'></script>
<script type="376714593608de8c39e32b38-text/javascript" src='https://stats.wp.com/e-202139.js' async='async' defer='defer'></script>
<script type="376714593608de8c39e32b38-text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:7.3.3',blog:'11524731',post:'189109',tz:'-6',srv:'www.r-bloggers.com'} ]);
	_stq.push([ 'clickTrackerInit', '11524731', '189109' ]);
</script>
    <script type="376714593608de8c39e32b38-text/javascript">
        jQuery(document).ready(function ($) {

            for (let i = 0; i < document.forms.length; ++i) {
                let form = document.forms[i];
				if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="LHfQMdbo_Al" value="8I4awxr7kvVDt" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="zxVu-DITS" value="Nce7adstg1[H]" />'); }
if ($(form).attr("method") != "get") { $(form).append('<input type="hidden" name="fFcgQ_OCSUuEzl" value="DRK3bIW0w8L" />'); }
            }

            $(document).on('submit', 'form', function () {
				if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="LHfQMdbo_Al" value="8I4awxr7kvVDt" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="zxVu-DITS" value="Nce7adstg1[H]" />'); }
if ($(this).attr("method") != "get") { $(this).append('<input type="hidden" name="fFcgQ_OCSUuEzl" value="DRK3bIW0w8L" />'); }
                return true;
            });

            jQuery.ajaxSetup({
                beforeSend: function (e, data) {

                    if (data.type !== 'POST') return;

                    if (typeof data.data === 'object' && data.data !== null) {
						data.data.append("LHfQMdbo_Al", "8I4awxr7kvVDt");
data.data.append("zxVu-DITS", "Nce7adstg1[H]");
data.data.append("fFcgQ_OCSUuEzl", "DRK3bIW0w8L");
                    }
                    else {
                        data.data = data.data + '&LHfQMdbo_Al=8I4awxr7kvVDt&zxVu-DITS=Nce7adstg1[H]&fFcgQ_OCSUuEzl=DRK3bIW0w8L';
                    }
                }
            });

        });
    </script>
	<script src="/cdn-cgi/scripts/7d0fa10a/cloudflare-static/rocket-loader.min.js" data-cf-settings="376714593608de8c39e32b38-|49" defer=""></script></body>
</html>
<!-- Dynamic page generated in 1.047 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2021-10-01 07:08:43 -->

<!-- Compression = gzip -->